(function(){"use strict";var e={7235:function(e,t,n){n.d(t,{SR:function(){return c},ST:function(){return u},a1:function(){return r},mn:function(){return s},wI:function(){return i}});n(3375),n(9225),n(3972),n(9209),n(5714),n(7561),n(6197);var o=n(5897);let a=null;const l=new Set;function r(){a||(a=new WebSocket("ws://localhost:9090/ws/chat"),a.onopen=()=>{console.log("ì „ì—­ Websocket open")},a.onmessage=e=>{let t=JSON.parse(e.data);const n=(0,o.L)();n.handleIncomingMessage(t),l.forEach((e=>e(t)))},a.onclose=()=>{console.warn("ì „ì—­ WebSocket closed. Reconnecting in 3s..."),a=null,setTimeout(initSocket,3e3)},a.onerror=e=>{console.error("ì „ì—­ WebSocket error",e)})}function s(){return a}function i(e){console.log("ì „ì—­ send"),a&&a.readyState===WebSocket.OPEN&&(console.log("ì „ì—­ action"),a.send(JSON.stringify(e)))}function c(e){l.add(e)}function u(e){l.delete(e)}},6017:function(e,t,n){var o=n(595);const a=(0,o.A)();t.A=a},988:function(e,t,n){var o=n(5130),a=n(6768);const l={key:0},r={key:1},s={key:1},i={key:1};function c(e,t,n,o,c,u){const d=(0,a.g2)("Login"),m=(0,a.g2)("Header"),h=(0,a.g2)("LeftMenu"),g=(0,a.g2)("router-view"),p=(0,a.g2)("AdminLogin"),k=(0,a.g2)("AdminHeader"),v=(0,a.g2)("AdminLeftMenu");return(0,a.uX)(),(0,a.CE)("div",null,[o.isAdmin?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("div",null,[o.isLogin?((0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(m),(0,a.bF)(h),(0,a.bF)(g)])):((0,a.uX)(),(0,a.Wv)(d,{key:0}))])])),o.isAdmin?((0,a.uX)(),(0,a.CE)("div",s,[(0,a.Lk)("div",null,[o.isLogin?((0,a.uX)(),(0,a.CE)("div",i,[(0,a.bF)(k),(0,a.bF)(v),(0,a.bF)(g)])):((0,a.uX)(),(0,a.Wv)(p,{key:0}))])])):(0,a.Q3)("",!0)])}n(4979);var u=n(144),d=n(973),m=n(4232),h=n.p+"img/logomini.8cb619d3.svg",g=n.p+"img/userlogin.4e568785.svg",p=n.p+"img/userlogout.7b94e9ed.svg";const k={class:"header"},v={class:"dpf"},f={class:"em"},L={class:"chatW"},C={class:"chatHd"},E={key:0,class:"impsbChat"},I={key:1,class:"psbChat"};function b(e,t,n,o,l,r){const s=(0,a.g2)("ChatModal");return(0,a.uX)(),(0,a.CE)("div",k,[t[12]||(t[12]=(0,a.Lk)("h1",null,[(0,a.Lk)("img",{src:h,alt:"TOYCHATLOGO"})],-1)),(0,a.Lk)("ul",v,[(0,a.Lk)("li",null,[t[3]||(t[3]=(0,a.Lk)("img",{src:g,alt:"ì‚¬ëžŒ ëª¨ì–‘ì˜ ì•„ì´ì½˜"},null,-1)),(0,a.Lk)("span",f,(0,m.v_)(o.nick),1),t[4]||(t[4]=(0,a.eW)("Â Â ë‹˜Â Â Â ì ‘ì†ì¤‘ "))]),(0,a.Lk)("li",null,[(0,a.Lk)("a",{onClick:t[0]||(t[0]=(...e)=>r.fn_kakaoLogout&&r.fn_kakaoLogout(...e))},t[5]||(t[5]=[(0,a.Lk)("img",{src:p,alt:"ë¡œê·¸ì•„ì›ƒ ì•„ì´ì½˜"},null,-1),(0,a.eW)("ë¡œê·¸ì•„ì›ƒ")]))]),(0,a.Lk)("li",null,[(0,a.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>o.openChatModal&&o.openChatModal(...e))},t[6]||(t[6]=[(0,a.Lk)("div",{class:"roadBox",title:"ì±„íŒ…ì„ ì‹œìž‘í•˜ë ¤ë©´ í´ë¦­í•´ì£¼ì„¸ìš”!"},[(0,a.Lk)("span",{class:"circle circle1"}),(0,a.Lk)("span",{class:"circle circle2"}),(0,a.Lk)("span",{class:"circle circle3"})],-1)]))])]),(0,a.bF)(s,{ref:"chatModal",modelValue:o.isModalVisible,"onUpdate:modelValue":t[2]||(t[2]=e=>o.isModalVisible=e),userId:o.userId,nick:o.nick,role:o.role,chatroomId:o.chatroomId,onResetChatroomId:o.resetChatroomId},{default:(0,a.k6)((()=>[t[11]||(t[11]=(0,a.Lk)("h2",{class:"dpn"},"ëŒ€í™”",-1)),(0,a.Lk)("div",L,[(0,a.Lk)("ul",C,[t[10]||(t[10]=(0,a.Lk)("li",null,"ì§ˆë¬¸ì´ ìžˆìœ¼ì‹ ê°€ìš”? ì§€ê¸ˆ ë¬¸ì˜í•˜ì„¸ìš”!",-1)),(0,a.Lk)("li",null,[o.isActivAdmin?((0,a.uX)(),(0,a.CE)("div",I,[t[8]||(t[8]=(0,a.Lk)("p",null,"ì˜¨ë¼ì¸ ë¬¸ì˜ê°€ ê°€ëŠ¥í•œ ìƒíƒœìž…ë‹ˆë‹¤.",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.activeAdmin,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t},(0,m.v_)(e),1)))),128)),t[9]||(t[9]=(0,a.Lk)("p",{class:"agentChat"},"ì•ˆë…•í•˜ì„¸ìš”! ì–´ë–»ê²Œ ë„ì™€ë“œë¦´ê¹Œìš”?",-1))])):((0,a.uX)(),(0,a.CE)("div",E,t[7]||(t[7]=[(0,a.Lk)("p",{class:"timeAlert"},[(0,a.eW)(" ì˜¤ì „ 10ì‹œë¶€í„° ì˜¤í›„ 6ì‹œê¹Œì§€"),(0,a.Lk)("span",{class:"dpn"},"ê°€ëŠ¥í•œ ìƒë‹´ì›ì´ ì—†ìŠµë‹ˆë‹¤.")],-1)])))])])])])),_:1},8,["modelValue","userId","nick","role","chatroomId","onResetChatroomId"])])}n(4114);var y=n(6035),A=n(4373),S=n(6017),_={components:{ChatModal:y.A},methods:{fn_kakaoLogout(){window.Kakao.Auth.logout((e=>{e&&(localStorage.setItem("isAuthenticated",!1),localStorage.setItem("id",""),localStorage.setItem("nick",""),this.router.push("/"))}))}},setup(){const e=(0,d.rd)(),t=(0,u.KR)(localStorage.getItem("id")),n=(0,u.KR)(localStorage.getItem("nick")),o=(0,u.KR)("USR"),l=(0,u.KR)(!1),r=(0,u.KR)(localStorage.getItem("chatroomId"));let s=null,i=(0,u.KR)([]),c=(0,u.KR)(!1);const m=()=>{r.value="",console.log("headerì—ì„œ emit ë°›ìŒ")},h=()=>{""==r.value?A.A.post("/api/chat/create",{id:t.value,nick:n.value}).then((e=>{r.value=e.data.chatroomId,l.value=!0})):l.value=!0},g=()=>{s=new WebSocket("ws://localhost:9090/ws/adminOnList?role=usr"),s.onopen=()=>{console.log("activeAdminChkSocket connection opened")},s.onmessage=e=>{console.log("activeAdminChkSocket got message");let t=e.data,n=t.split(",");i.value=n,c.value=i.value[0].length>0},s.onclose=()=>{console.log("activeAdminChkSocket connection closed")},s.onerror=e=>{console.error("activeAdminChkSocket error: ",e)}};return(0,a.sV)((()=>{g(),S.A.on("reset-chatroom-id",m)})),(0,a.hi)((()=>{s&&s.close()})),(0,a.xo)((()=>{S.A.off("reset-chatroom-id",m)})),(0,a.wB)(r,(e=>{localStorage.setItem("chatroomId",e)})),{router:e,userId:t,nick:n,role:o,isModalVisible:l,chatroomId:r,activeAdmin:i,isActivAdmin:c,openChatModal:h,openActiveAdminChkSocket:g,resetChatroomId:m}}},w=n(1241);const P=(0,w.A)(_,[["render",b]]);var R=P,M=n.p+"img/chatlist.002fcb5e.svg";const K={class:"leftMenu"};function X(e,t){const n=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",K,[t[2]||(t[2]=(0,a.Lk)("p",{class:"dpn"},"ì™¼ìª½ë©”ë‰´",-1)),(0,a.Lk)("ul",null,[(0,a.Lk)("li",null,[(0,a.bF)(n,{to:"/chat/list","active-class":"on"},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.Lk)("img",{src:M,alt:"ì±„íŒ… ì´ë ¥ ì•„ì´ì½˜"},null,-1),(0,a.eW)("ì±„íŒ… ì´ë ¥ ")]))),_:1,__:[0]})]),(0,a.Lk)("li",null,[(0,a.bF)(n,{to:"/chat/paginationTest","active-class":"on"},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.Lk)("img",{src:M,alt:"ì±„íŒ… ì´ë ¥ ì•„ì´ì½˜"},null,-1),(0,a.eW)("íŽ˜ì´ì§• í…ŒìŠ¤íŠ¸ ")]))),_:1,__:[1]})])])])}const T={},N=(0,w.A)(T,[["render",X]]);var W=N;const O={class:"contentW"};function V(e,t,n,o,l,r){const s=(0,a.g2)("ChatList");return(0,a.uX)(),(0,a.CE)("div",O,[t[0]||(t[0]=(0,a.Lk)("ul",null,[(0,a.Lk)("li",{class:"tit"},"ì±„íŒ… ì´ë ¥"),(0,a.Lk)("li",{class:"navi"},[(0,a.Lk)("ul",null,[(0,a.Lk)("li",null,"í™ˆ"),(0,a.Lk)("li",null,"ì±„íŒ…ì´ë ¥")])])],-1)),(0,a.Lk)("div",null,[(0,a.bF)(s)])])}var F=n(5072),j={components:{ChatList:F["default"]}};const B=(0,w.A)(j,[["render",V]]);var H=B;const x={class:"bg"};function D(e,t,n,o,l,r){return(0,a.uX)(),(0,a.CE)("div",x,[t[2]||(t[2]=(0,a.Lk)("p",null,"TOYCHAT",-1)),(0,a.Lk)("a",{onClick:t[0]||(t[0]=(...e)=>r.fn_kakaoLogin&&r.fn_kakaoLogin(...e))},t[1]||(t[1]=[(0,a.Lk)("img",{src:"//k.kakaocdn.net/14/dn/btqCn0WEmI3/nijroPfbpCa4at5EIsjyf0/o.jpg",width:"222"},null,-1)]))])}var G={methods:{fn_kakaoLogin(){window.Kakao.Auth.login({scope:"profile_nickname",success:this.fn_getKakaoAccount})},fn_getKakaoAccount(){window.Kakao.API.request({url:"/v2/user/me",success:e=>{var t=e.id,n=e.kakao_account.profile.nickname;localStorage.setItem("isAuthenticated",!0),localStorage.setItem("id",t),localStorage.setItem("nick",n),localStorage.setItem("role","USR"),this.$router.go("/chat/list")},fail:e=>{console.log(e),localStorage.setItem("isAuthenticated",!1)}})}}};const U=(0,w.A)(G,[["render",D]]);var $=U,Q=n(6614);const q={class:"header"},Y={class:"dpf"},z={class:"em"};function J(e,t,n,o,l,r){return(0,a.uX)(),(0,a.CE)("div",q,[t[4]||(t[4]=(0,a.Lk)("h1",null,[(0,a.Lk)("img",{src:h,alt:"TOYCHATLOGO"}),(0,a.eW)(" ê´€ë¦¬ìž ")],-1)),(0,a.Lk)("ul",Y,[(0,a.Lk)("li",null,[t[1]||(t[1]=(0,a.Lk)("img",{src:g,alt:"ì‚¬ëžŒ ëª¨ì–‘ì˜ ì•„ì´ì½˜"},null,-1)),(0,a.Lk)("span",z,(0,m.v_)(o.nick),1),t[2]||(t[2]=(0,a.eW)("Â Â ë‹˜Â Â Â ì ‘ì†ì¤‘ "))]),(0,a.Lk)("li",null,[(0,a.Lk)("a",{onClick:t[0]||(t[0]=(...e)=>o.handleLogout&&o.handleLogout(...e))},t[3]||(t[3]=[(0,a.Lk)("img",{src:p,alt:"ë¡œê·¸ì•„ì›ƒ ì•„ì´ì½˜"},null,-1),(0,a.eW)("ë¡œê·¸ì•„ì›ƒ")]))])])])}var Z=n(6400),ee=n(7530),te={setup(){const e=(0,d.rd)(),t=(0,u.KR)(localStorage.getItem("adminNick")),n=()=>{localStorage.removeItem("jwt"),localStorage.removeItem("adminId"),localStorage.removeItem("adminNick"),e.push("/admin")},o={apiKey:"AIzaSyBUochlrZu3cwXnaW907_ZvHPPNQkCHUaE",authDomain:"toychat-1a2b7.firebaseapp.com",projectId:"toychat-1a2b7",storageBucket:"toychat-1a2b7.appspot.com",messagingSenderId:"286624352269",appId:"1:286624352269:web:c05c71880d215786ea2d44",measurementId:"G-8LWB2ZRCW1"},l=(0,Z.Wp)(o),r=(0,ee.dG)(l);(0,ee.xD)(r,(e=>{console.log("Message received. ",e)})),Notification.requestPermission().then((e=>{"granted"===e||alert("Unable to get permission to notify.")}));const s="BB-jj2EArj_qbaSA6eCicuMBbt9CnaErLl7hHthN1M3UQif7XpnA6jQpiQ2ShqMmWCBX9zWbN_0F903c8K4NRwo",i=()=>{console.log(s),(0,ee.gf)(r,{vapidKey:s}).then((e=>{if(console.log("current Token?"),e)try{let t=localStorage.getItem("adminId");A.A.post("/api/fcm/createKey",{fcmKey:e,id:t})}catch(t){console.error("Error fetching token:",t)}else console.log("No registration token available. Request permission to generate one.")})).catch((e=>{console.log("An error occurred while retrieving token. ",e)}))};return(0,a.sV)((()=>{i()})),{nick:t,handleLogout:n}}};const ne=(0,w.A)(te,[["render",J]]);var oe=ne;const ae={class:"leftMenu"};function le(e,t){const n=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",ae,[t[3]||(t[3]=(0,a.Lk)("p",{class:"dpn"},"ì™¼ìª½ë©”ë‰´",-1)),(0,a.Lk)("ul",null,[(0,a.Lk)("li",null,[(0,a.bF)(n,{to:"/admin/chat/mnglist","active-class":"on"},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.Lk)("img",{src:M,alt:"ì±„íŒ… ì´ë ¥ ì•„ì´ì½˜"},null,-1),(0,a.eW)("ì™„ë£Œì±„íŒ…ê´€ë¦¬ ")]))),_:1,__:[0]})]),(0,a.Lk)("li",null,[(0,a.bF)(n,{to:"/admin/chat/serviceList","active-class":"on"},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.Lk)("img",{src:M,alt:"ì±„íŒ… ì´ë ¥ ì•„ì´ì½˜"},null,-1),(0,a.eW)("ì‹¤ì‹œê°„ ì±„íŒ… ì§€ì› ")]))),_:1,__:[1]})]),(0,a.Lk)("li",null,[(0,a.bF)(n,{to:"/admin/chat/myList","active-class":"on"},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.Lk)("img",{src:M,alt:"ì±„íŒ… ì´ë ¥ ì•„ì´ì½˜"},null,-1),(0,a.eW)("ë‚´ ì±„íŒ… ")]))),_:1,__:[2]})])])])}const re={},se=(0,w.A)(re,[["render",le]]);var ie=se;const ce={class:"bg"},ue={class:"login"},de={key:0,class:"error"};function me(e,t,n,l,r,s){return(0,a.uX)(),(0,a.CE)("div",ce,[(0,a.Lk)("div",ue,[t[6]||(t[6]=(0,a.Lk)("h1",null,"Login",-1)),(0,a.Lk)("form",{onSubmit:t[2]||(t[2]=(0,o.D$)(((...e)=>s.handleLogin&&s.handleLogin(...e)),["prevent"]))},[(0,a.Lk)("div",null,[t[3]||(t[3]=(0,a.Lk)("label",{for:"username"},"Id:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>r.id=e),id:"id",required:""},null,512),[[o.Jo,r.id]])]),(0,a.Lk)("div",null,[t[4]||(t[4]=(0,a.Lk)("label",{for:"password"},"Password:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>r.password=e),id:"password",required:""},null,512),[[o.Jo,r.password]])]),t[5]||(t[5]=(0,a.Lk)("button",{type:"submit"},"Login",-1)),r.error?((0,a.uX)(),(0,a.CE)("div",de,(0,m.v_)(r.error),1)):(0,a.Q3)("",!0)],32)])])}var he={data(){return{id:"",password:"",error:""}},methods:{async handleLogin(){try{const e=await A.A.post("/api/admin/login",{id:this.id,pw:this.password}),t=e.data.jwt,n=e.data.nick;localStorage.setItem("jwt",t),localStorage.setItem("adminNick",n),localStorage.setItem("adminId",this.id),this.$router.go("/admin/chat/mnglist")}catch(e){this.error="Login failed: "+(e.response?.data?.message||"Unknown error"),this.$router.go("/admin")}}}};const ge=(0,w.A)(he,[["render",me],["__scopeId","data-v-038f0e7f"]]);var pe=ge;function ke(e,t){return(0,a.uX)(),(0,a.CE)("div",null,"admin home")}const ve={},fe=(0,w.A)(ve,[["render",ke]]);var Le=fe,Ce={name:"App",components:{Header:R,LeftMenu:W,Login:$,Body:H,AdminHeader:oe,AdminLeftMenu:ie,AdminLogin:pe,Home:Q["default"],AdminHome:Le},setup(){(0,d.lq)();const e=(0,d.rd)(),t=(0,u.KR)(null),n=(0,u.KR)(null),o=async()=>{const e="true"===localStorage.getItem("isAuthenticated");let n=!1;const o=localStorage.getItem("jwt");if(o)try{const e=JSON.parse(atob(o.split(".")[1])),t=e.exp&&Date.now()/1e3>e.exp;n=!t}catch(a){n=!1}return t.value?n:e};return e.afterEach((async(e,a)=>{t.value=e.path.startsWith("/admin"),n.value=await o()})),{isAdmin:t,isLogin:n}}};const Ee=(0,w.A)(Ce,[["render",c]]);var Ie=Ee;const be=[{path:"/",name:"Home",component:()=>Promise.resolve().then(n.bind(n,6614))},{path:"/chat/list",name:"ChatList",component:()=>Promise.resolve().then(n.bind(n,5072))},{path:"/chat/paginationTest",name:"PaginationTest",component:()=>n.e(489).then(n.bind(n,1489))},{path:"/admin",name:"AdminHome",component:Le},{path:"/admin/chat/mnglist",name:"AdminChatManage",component:()=>n.e(754).then(n.bind(n,7754))},{path:"/admin/chat/serviceList",name:"AdminChatService",component:()=>n.e(361).then(n.bind(n,1361))},{path:"/admin/chat/myList",name:"AdminMyChatManage",component:()=>n.e(111).then(n.bind(n,5111))},{path:"/admin/chat/empty",name:"AdminEmpty",component:()=>n.e(913).then(n.bind(n,2913))}],ye=(0,d.aE)({history:(0,d.LA)(),routes:be});var Ae=ye,Se=n(2261),_e=n(5827),we=n(7235);const Pe=(0,o.Ef)(Ie).use(Ae),Re=(0,Se.Ey)();Re.use(_e.A),Pe.config.globalProperties.$axios=A.A,Pe.use(Re),Pe.mount("#app"),(0,we.a1)()},5897:function(e,t,n){n.d(t,{L:function(){return a}});var o=n(2261);const a=(0,o.nY)("chat",{state:()=>({chatList:[],unreadCounts:{}}),actions:{handleIncomingMessage(e){const t=this.chatList.find((t=>t.chatroomId===e.chatroomId));if(t){var n={...t,lastContent:e.content,lastCredt:e.credt,status:"END"===e.type?"03":t.adm?"02":"01"};console.log("handling pushMsg : ",n),this.chatList=[n,...this.chatList.filter((t=>t.chatroomId!==e.chatroomId))]}else{n={chatroomId:e.chatroomId,credt:e.credt,usr:{id:e.id,nick:e.nick},lastContent:e.content,lastCredt:e.credt,status:"01"};this.chatList.unshift(n)}this.unreadCounts[e.chatroomId]=(this.unreadCounts[e.chatroomId]||0)+1},markAsRead(e){console.log("markAsRead : "+e),this.unreadCounts[e]=0},setChatList(e){this.chatList=e},resetStore(){this.chatList=[],this.unreadCounts={}}},persist:{key:"chat-store",storage:localStorage,paths:["chatList","unreadCounts"]}})},9383:function(e,t,n){n.d(t,{A:function(){return p}});var o=n(6768),a=n(4232);const l={style:{display:"flex","align-items":"center"}},r={key:0},s=["onClick"],i={key:1};function c(e,t,n,c,u,d){return(0,o.uX)(),(0,o.CE)("div",l,[e.leftmostPage>n.PAGE_PER_SECTION?((0,o.uX)(),(0,o.CE)("span",r,[(0,o.Lk)("a",{onClick:t[0]||(t[0]=()=>{e.leftmostPage-=n.PAGE_PER_SECTION,e.onChangeCurPage(e.leftmostPage)})},"<")])):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.getPaginationArray(e.leftmostPage),(t=>((0,o.uX)(),(0,o.CE)("span",{class:"page",key:t},[(0,o.Lk)("a",{class:(0,a.C4)({on:t===e.curPage}),onClick:()=>{e.onChangeCurPage(t)}},(0,a.v_)(t),11,s)])))),128)),e.leftmostPage+n.PAGE_PER_SECTION<=e.totalPage?((0,o.uX)(),(0,o.CE)("span",i,[(0,o.Lk)("a",{onClick:t[1]||(t[1]=()=>{e.leftmostPage+=n.PAGE_PER_SECTION,e.onChangeCurPage(e.leftmostPage)})},">")])):(0,o.Q3)("",!0)])}n(4114);var u=n(144),d={props:{list:Array,ITEM_PER_PAGE:Number,PAGE_PER_SECTION:Number},emits:["change-page"],setup(e,{emit:t}){return{...m(e,t)}}};const m=(e,t)=>{const n=(0,u.KR)(1),o=(0,u.KR)(1),a=Math.ceil(e.list.length/(e.ITEM_PER_PAGE||1)),l=t=>{const n=[];for(let o=t;o<Math.min(a+1,t+e.PAGE_PER_SECTION);o++)n.push(o);return n},r=e=>{n.value=e,t("change-page",e)};return{leftmostPage:o,curPage:n,totalPage:a,getPaginationArray:l,onChangeCurPage:r}};var h=n(1241);const g=(0,h.A)(d,[["render",c]]);var p=g},124:function(e,t,n){n.d(t,{A:function(){return m}});var o=n(6768),a=n(5130),l=n(4232);function r(e,t,n,r,s,i){return r.visible?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"modal-overlay",onClick:t[4]||(t[4]=(0,a.D$)(((...e)=>r.close&&r.close(...e)),["self"]))},[(0,o.Lk)("div",{class:"modal-content",ref:"modalContent",onMousedown:t[1]||(t[1]=(...e)=>r.startDrag&&r.startDrag(...e)),onMouseup:t[2]||(t[2]=(...e)=>r.stopDrag&&r.stopDrag(...e)),onMousemove:t[3]||(t[3]=(...e)=>r.drag&&r.drag(...e))},[(0,o.Lk)("button",{class:"modal-close",onClick:t[0]||(t[0]=(...e)=>r.close&&r.close(...e))},"Ã—"),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.messages,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t},[(0,o.Lk)("p",null,(0,l.v_)(e.nick)+" : "+(0,l.v_)(e.content),1)])))),128))],544)])):(0,o.Q3)("",!0)}var s=n(144),i=n(4373),c={props:{modalValue:{type:Boolean,default:!1},chatroomId:{type:String,default:""}},emits:["update:modalValue"],setup(e,{emit:t}){const n=(0,o.EW)((()=>e.chatroomId)),a=(0,s.KR)(e.modalValue),l=(0,s.KR)(null);let r=(0,s.KR)(!1),c=0,u=0,d=0,m=0;const h=(0,s.KR)("");let g=(0,s.KR)([]);const p=async()=>{try{const e=await i.A.post("/api/chat/chatList",{chatroomId:n.value});g.value=e.data}catch(e){console.error("Error fetching chat list:",e)}},k=()=>{n.value="",g.value=[],t("update:modalValue",!1),t("reset-chatroom-id")},v=e=>{r.value=!0,c=e.clientX,u=e.clientY;const t=l.value.getBoundingClientRect();d=t.left,m=t.top},f=()=>{r.value=!1},L=e=>{if(!r.value)return;const t=e.clientX-c,n=e.clientY-u;l.value.style.left=`${d+t}px`,l.value.style.top=`${m+n}px`};return(0,o.wB)((()=>e.modalValue),(e=>{a.value=e})),(0,o.wB)((()=>n.value),(e=>{e&&p()})),{chatroomId:n,visible:a,close:k,modalContent:l,startDrag:v,stopDrag:f,drag:L,message:h,messages:g}}},u=n(1241);const d=(0,u.A)(c,[["render",r],["__scopeId","data-v-4abc59c4"]]);var m=d},5072:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var o=n(6768),a=n(4232);const l={class:"contentW"},r={class:"tbl"},s=["onClick"],i={key:0};function c(e,t,n,c,u,d){const m=(0,o.g2)("Pagination"),h=(0,o.g2)("ChatHistoryModal"),g=(0,o.g2)("ChatModal");return(0,o.uX)(),(0,o.CE)("div",l,[t[4]||(t[4]=(0,o.Lk)("ul",null,[(0,o.Lk)("li",{class:"tit"},"ì±„íŒ… ì´ë ¥"),(0,o.Lk)("li",{class:"navi"},[(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,"í™ˆ"),(0,o.Lk)("li",null,"ì±„íŒ… ì´ë ¥")])])],-1)),(0,o.Lk)("div",null,[t[3]||(t[3]=(0,o.Lk)("h1",{class:"dpn"},"ì±„íŒ… ì´ë ¥",-1)),(0,o.Lk)("table",r,[t[2]||(t[2]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("td",{class:"wd6"},"roomId"),(0,o.Lk)("td",{class:"wd12"},"ìƒì„±ì¼"),(0,o.Lk)("td",{class:"wd12"},"ë‹µë³€ìž"),(0,o.Lk)("td",null,"ì±„íŒ…"),(0,o.Lk)("td",{class:"wd12"},"ë§ˆì§€ë§‰ ì±„íŒ…ì¼"),(0,o.Lk)("td",{class:"wd12"},"ìƒíƒœ(ëŒ€ê¸°/ì§„í–‰ì¤‘/ì™„ë£Œ)")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(c.chatrooms?.slice(c.pageStartIdx,c.pageStartIdx+c.ITEM_PER_PAGE),(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.chatroomId,onClick:t=>"03"===e.status?c.openChatHistoryModal(e.chatroomId):c.openChatModal(e.chatroomId)},[(0,o.Lk)("td",null,(0,a.v_)(e.chatroomId),1),(0,o.Lk)("td",null,(0,a.v_)(e.credt),1),(0,o.Lk)("td",null,(0,a.v_)(e.adm?.nick||""),1),(0,o.Lk)("td",null,[(0,o.eW)((0,a.v_)(e.lastContent)+" ",1),null!=c.unreadCounts[e.chatroomId]?((0,o.uX)(),(0,o.CE)("p",i," ( "+(0,a.v_)(c.unreadCounts[e.chatroomId])+" ) ",1)):(0,o.Q3)("",!0)]),(0,o.Lk)("td",null,(0,a.v_)(e.lastCredt),1),(0,o.Lk)("td",null,(0,a.v_)(e.status),1)],8,s)))),128))])]),c.chatrooms.length>0?((0,o.uX)(),(0,o.Wv)(m,(0,o.v6)({key:0,list:c.chatrooms},{ITEM_PER_PAGE:c.ITEM_PER_PAGE,PAGE_PER_SECTION:c.PAGE_PER_SECTION},{onChangePage:c.onChangePage}),null,16,["list","onChangePage"])):(0,o.Q3)("",!0)]),(0,o.bF)(h,{modalValue:c.isChatHistoryModalVisible,"onUpdate:modalValue":t[0]||(t[0]=e=>c.isChatHistoryModalVisible=e),chatroomId:c.chatroomId},null,8,["modalValue","chatroomId"]),(0,o.bF)(g,{modelValue:c.isModalVisible,"onUpdate:modelValue":t[1]||(t[1]=e=>c.isModalVisible=e),userId:c.userId,nick:c.nick,role:c.role,chatroomId:c.chatroomId},null,8,["modelValue","userId","nick","role","chatroomId"])])}var u=n(144),d=n(4373),m=n(124),h=n(6035),g=n(9383),p=n(5897),k=n(7235),v={components:{ChatHistoryModal:m.A,ChatModal:h.A,Pagination:g.A},setup(){const e=(0,p.L)(),t=(0,u.KR)(localStorage.getItem("id")),n=(0,u.KR)(localStorage.getItem("nick")),a=(0,u.KR)("USR"),l=(0,o.EW)((()=>e.chatList)),r=(0,o.EW)((()=>e.unreadCounts)),s=(0,u.KR)(""),i=(0,u.KR)(!1),c=(0,u.KR)(!1),m=(0,u.KR)(20),h=(0,u.KR)(10);let g=(0,u.KR)(1);const v=(0,o.EW)((()=>(g.value-1)*m.value)),f=e=>{g.value=e},L=async()=>{try{const n=await d.A.post("/api/chat/chatroomList",{id:t.value});e.setChatList(n.data)}catch(n){console.error("Error fetching chat list:",n)}},C=e=>{s.value=e,i.value=!0},E=t=>{s.value=t,c.value=!0,e.markAsRead(t)};function I(e){return new Promise((t=>{e.readyState===WebSocket.OPEN?t():e.addEventListener("open",t,{once:!0})}))}return(0,o.sV)((async()=>{await L();const t=(0,k.mn)();await I(t);const n=e.chatList.filter((e=>"02"===e.status)).map((e=>e.chatroomId));n.forEach((e=>{const t={chatroomId:e,type:"REJOIN"};(0,k.wI)(t)}))})),{userId:t,nick:n,role:a,chatrooms:l,unreadCounts:r,chatroomId:s,isChatHistoryModalVisible:i,isModalVisible:c,openChatHistoryModal:C,openChatModal:E,ITEM_PER_PAGE:m,PAGE_PER_SECTION:h,pageStartIdx:v,onChangePage:f}}},f=n(1241);const L=(0,f.A)(v,[["render",c]]);var C=L},6035:function(e,t,n){n.d(t,{A:function(){return v}});var o=n(6768),a=n(5130),l=n(4232),r=n.p+"img/send.cc05441e.svg";const s={class:"userChatBox"},i={class:"inputMsg"};function c(e,t,n,c,u,d){return(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",{class:"modal-overlay",onClick:t[8]||(t[8]=(0,a.D$)(((...e)=>c.minimize&&c.minimize(...e)),["self"]))},[(0,o.Lk)("div",{class:"modal-content",ref:"modalContent",onMousedown:t[5]||(t[5]=(...e)=>c.startDrag&&c.startDrag(...e)),onMouseup:t[6]||(t[6]=(...e)=>c.stopDrag&&c.stopDrag(...e)),onMousemove:t[7]||(t[7]=(...e)=>c.drag&&c.drag(...e))},[(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>c.minimize&&c.minimize(...e)),style:{padding:"1.6rem"}},"ìµœì†Œí™”"),(0,o.Lk)("button",{class:"modal-close",onClick:t[1]||(t[1]=(...e)=>c.close&&c.close(...e))}),(0,o.RG)(e.$slots,"default"),(0,o.Lk)("div",s,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(c.messages,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t},[(0,o.Lk)("p",null,(0,l.v_)(e.nick)+" : "+(0,l.v_)(e.content),1)])))),128))]),(0,o.Lk)("div",i,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>c.message=e),onKeydown:t[3]||(t[3]=(...e)=>c.enter&&c.enter(...e)),placeholder:"ë©”ì‹œì§€ ìž‘ì„±.."},null,544),[[a.Jo,c.message]]),(0,o.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>c.sendMessage&&c.sendMessage(...e)),class:"sendBtn"},t[9]||(t[9]=[(0,o.Lk)("img",{src:r,alt:"ì „ì†¡ ë²„íŠ¼ ì•„ì´ì½˜"},null,-1)]))])],544)],512)),[[a.aG,c.visible]])}n(4114);var u=n(144),d=n(4373),m=n(6017),h=n(7235),g={props:{modelValue:{type:Boolean,default:!1},userId:{type:String,default:""},nick:{type:String,default:""},role:{type:String,default:""},chatroomId:{type:String,default:""}},methods:{closeChatroom(){closeProcess()}},setup(e,{emit:t}){const n=(0,o.EW)((()=>e.userId)),a=(0,o.EW)((()=>e.nick)),l=(0,o.EW)((()=>e.role)),r=(0,o.EW)((()=>e.chatroomId)),s=(0,u.KR)(e.modelValue),i=(0,u.KR)(null),c=(0,u.KR)(!1);let g=0,p=0,k=0,v=0;const f=(0,u.KR)(""),L=(0,u.KR)([]);function C(e){const t={nick:e.nick,content:e.content};console.log("ðŸ’¬ ëª¨ë‹¬ got msg",t),L.value.push(t)}const E=e=>{let t="ENTER"===e?`${a.value}ë‹˜ì´ ìž…ìž¥í•˜ì˜€ìŠµë‹ˆë‹¤.`:"END"===e?"ëŒ€í™”ê°€ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.":f.value;const o={chatroomId:r.value,id:n.value,nick:a.value,content:t,type:e};return o},I=()=>{(0,h.wI)(E("TALK")),f.value=""},b=()=>{(0,h.wI)(E("ENTER"))},y=()=>{d.A.post("/api/chat/isNew",{id:n.value,chatroomId:r.value}).then((e=>{var t=e.data;t&&("USR"==l.value&&A(),b("ENTER"))}))},A=()=>{let e={nick:"TOYCHAT",content:`ì•ˆë…•í•˜ì„¸ìš”! ì–´ë–»ê²Œ ë„ì™€ë“œë¦´ê¹Œìš”? ${String.fromCodePoint(128522)}`};L.value.push(e)},S=()=>{d.A.post("/api/chat/liveChatList",{chatroomId:r.value}).then((e=>{L.value=e.data}))},_=()=>{var e=window.event.keyCode;13==e&&I()},w=()=>{confirm("ì¢…ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")&&P()},P=()=>{(0,h.wI)(E("END")),r.value="",L.value=[],t("update:modelValue",!1),m.A.emit("reset-chatroom-id")},R=()=>{t("update:modelValue",!1)},M=e=>{c.value=!0,g=e.clientX,p=e.clientY;const t=i.value.getBoundingClientRect();k=t.left,v=t.top},K=()=>{c.value=!1},X=e=>{if(!c.value)return;const t=e.clientX-g,n=e.clientY-p;i.value.style.left=`${k+t}px`,i.value.style.top=`${v+n}px`};return(0,o.wB)((()=>e.modelValue),(e=>{s.value=e,e&&(S(),y())})),(0,o.sV)((()=>{(0,h.SR)(C)})),(0,o.hi)((()=>{(0,h.ST)(C)})),{userId:n,nick:a,role:l,chatroomId:r,visible:s,enter:_,close:w,modalContent:i,startDrag:M,stopDrag:K,drag:X,message:f,messages:L,makeSendBody:E,sendMessage:I,minimize:R,closeProcess:P}}},p=n(1241);const k=(0,p.A)(g,[["render",c]]);var v=k},6614:function(e,t,n){n.r(t),n.d(t,{default:function(){return i}});var o=n(6768);function a(e,t){return(0,o.uX)(),(0,o.CE)("div",null,"user home22")}var l=n(1241);const r={},s=(0,l.A)(r,[["render",a]]);var i=s}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var l=t[o]={exports:{}};return e[o].call(l.exports,l,l.exports,n),l.exports}n.m=e,function(){var e=[];n.O=function(t,o,a,l){if(!o){var r=1/0;for(u=0;u<e.length;u++){o=e[u][0],a=e[u][1],l=e[u][2];for(var s=!0,i=0;i<o.length;i++)(!1&l||r>=l)&&Object.keys(n.O).every((function(e){return n.O[e](o[i])}))?o.splice(i--,1):(s=!1,l<r&&(r=l));if(s){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}l=l||0;for(var u=e.length;u>0&&e[u-1][2]>l;u--)e[u]=e[u-1];e[u]=[o,a,l]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,o){return n.f[o](e,t),t}),[]))}}(),function(){n.u=function(e){return"js/"+e+"."+{111:"c65eeae0",361:"3dd1b919",489:"9d303d0e",754:"8698b8d9",913:"af0fc976"}[e]+".js"}}(),function(){n.miniCssF=function(e){return"css/"+e+".d7b1cb4b.css"}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="test1:";n.l=function(o,a,l,r){if(e[o])e[o].push(a);else{var s,i;if(void 0!==l)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==o||d.getAttribute("data-webpack")==t+l){s=d;break}}s||(i=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+l),s.src=o),e[o]=[a];var m=function(t,n){s.onerror=s.onload=null,clearTimeout(h);var a=e[o];if(delete e[o],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach((function(e){return e(n)})),t)return t(n)},h=setTimeout(m.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=m.bind(null,s.onerror),s.onload=m.bind(null,s.onload),i&&document.head.appendChild(s)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,o,a,l){var r=document.createElement("link");r.rel="stylesheet",r.type="text/css",n.nc&&(r.nonce=n.nc);var s=function(n){if(r.onerror=r.onload=null,"load"===n.type)a();else{var o=n&&n.type,s=n&&n.target&&n.target.href||t,i=new Error("Loading CSS chunk "+e+" failed.\n("+o+": "+s+")");i.name="ChunkLoadError",i.code="CSS_CHUNK_LOAD_FAILED",i.type=o,i.request=s,r.parentNode&&r.parentNode.removeChild(r),l(i)}};return r.onerror=r.onload=s,r.href=t,o?o.parentNode.insertBefore(r,o.nextSibling):document.head.appendChild(r),r},t=function(e,t){for(var n=document.getElementsByTagName("link"),o=0;o<n.length;o++){var a=n[o],l=a.getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(l===e||l===t))return a}var r=document.getElementsByTagName("style");for(o=0;o<r.length;o++){a=r[o],l=a.getAttribute("data-href");if(l===e||l===t)return a}},o=function(o){return new Promise((function(a,l){var r=n.miniCssF(o),s=n.p+r;if(t(r,s))return a();e(o,s,null,a,l)}))},a={524:0};n.f.miniCss=function(e,t){var n={754:1};a[e]?t.push(a[e]):0!==a[e]&&n[e]&&t.push(a[e]=o(e).then((function(){a[e]=0}),(function(t){throw delete a[e],t})))}}}(),function(){var e={524:0};n.f.j=function(t,o){var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)o.push(a[2]);else{var l=new Promise((function(n,o){a=e[t]=[n,o]}));o.push(a[2]=l);var r=n.p+n.u(t),s=new Error,i=function(o){if(n.o(e,t)&&(a=e[t],0!==a&&(e[t]=void 0),a)){var l=o&&("load"===o.type?"missing":o.type),r=o&&o.target&&o.target.src;s.message="Loading chunk "+t+" failed.\n("+l+": "+r+")",s.name="ChunkLoadError",s.type=l,s.request=r,a[1](s)}};n.l(r,i,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,l,r=o[0],s=o[1],i=o[2],c=0;if(r.some((function(t){return 0!==e[t]}))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(i)var u=i(n)}for(t&&t(o);c<r.length;c++)l=r[c],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(u)},o=self["webpackChunktest1"]=self["webpackChunktest1"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(988)}));o=n.O(o)})();
//# sourceMappingURL=app.039dc3c9.js.map