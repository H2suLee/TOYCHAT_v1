{"version":3,"file":"js/242.2e5dd76d.js","mappings":"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","sources":["webpack://test1/./src/common/Pagination.vue","webpack://test1/./src/common/Pagination.vue?5f00","webpack://test1/./src/user/modules/components/chat/ChatHistoryModal.vue","webpack://test1/./src/user/modules/components/chat/ChatHistoryModal.vue?1830","webpack://test1/./src/user/modules/components/chat/ChatList.vue","webpack://test1/./src/user/modules/components/chat/ChatList.vue?6f6f"],"sourcesContent":["<template>\r\n  <div style=\"display: flex; align-items: center\">\r\n    <span v-if=\"leftmostPage > PAGE_PER_SECTION\">\r\n      <a\r\n        @click=\"\r\n          () => {\r\n            leftmostPage -= PAGE_PER_SECTION;\r\n            onChangeCurPage(leftmostPage);\r\n          }\r\n        \"\r\n        >&lt;</a\r\n      >\r\n    </span>\r\n    <span\r\n      class=\"page\"\r\n      v-for=\"page in getPaginationArray(leftmostPage)\"\r\n      :key=\"page\"\r\n    >\r\n      <a\r\n        :class=\"{ on: page === curPage }\"\r\n        @click=\"\r\n          () => {\r\n            onChangeCurPage(page);\r\n          }\r\n        \"\r\n      >\r\n        {{ page }}</a\r\n      >\r\n    </span>\r\n    <span v-if=\"leftmostPage + PAGE_PER_SECTION <= totalPage\">\r\n      <a\r\n        @click=\"\r\n          () => {\r\n            leftmostPage += PAGE_PER_SECTION;\r\n            onChangeCurPage(leftmostPage);\r\n          }\r\n        \"\r\n        >&gt;</a\r\n      >\r\n    </span>\r\n  </div>\r\n  <!-- \r\n  <p>totalArticles : {{ list.length }}</p>\r\n  <p>totalPage : {{ totalPage }}</p>\r\n  <p>leftmostPage : {{ leftmostPage }}</p>\r\n  <p>ITEM_PER_PAGE : {{ ITEM_PER_PAGE }}</p>\r\n  <p>PAGE_PER_SECTION : {{ PAGE_PER_SECTION }}</p>\r\n   -->\r\n</template>\r\n\r\n<script>\r\nimport { ref } from \"vue\";\r\n\r\nexport default {\r\n  props: {\r\n    list: Array,\r\n    ITEM_PER_PAGE: Number,\r\n    PAGE_PER_SECTION: Number,\r\n  },\r\n  emits: [\"change-page\"],\r\n  setup(props, { emit }) {\r\n    return {\r\n      ...usePagination(props, emit),\r\n    };\r\n  },\r\n};\r\n\r\nconst usePagination = (props, emit) => {\r\n  const curPage = ref(1);\r\n  const leftmostPage = ref(1);\r\n  const totalPage = Math.ceil(props.list.length / (props.ITEM_PER_PAGE || 1));\r\n\r\n  const getPaginationArray = (left) => {\r\n    // [left,left+1,left+2...] 로 원소의 개수를 PAGE_PER_SECTION 개 만드는 함수\r\n    const res = [];\r\n    for (\r\n      let i = left;\r\n      i < Math.min(totalPage + 1, left + props.PAGE_PER_SECTION);\r\n      i++\r\n    ) {\r\n      res.push(i);\r\n    }\r\n\r\n    return res;\r\n  };\r\n\r\n  const onChangeCurPage = (page) => {\r\n    curPage.value = page;\r\n    emit(\"change-page\", page);\r\n  };\r\n\r\n  return {\r\n    leftmostPage,\r\n    curPage,\r\n    totalPage,\r\n    //\r\n    getPaginationArray,\r\n    onChangeCurPage,\r\n  };\r\n};\r\n</script>\r\n\r\n<style>\r\n.page {\r\n  padding: 1rem;\r\n  cursor: pointer;\r\n}\r\n.page a.on {\r\n  font-weight: 900;\r\n  color: red;\r\n}\r\n</style>\r\n","import { render } from \"./Pagination.vue?vue&type=template&id=0bddd3b0\"\nimport script from \"./Pagination.vue?vue&type=script&lang=js\"\nexport * from \"./Pagination.vue?vue&type=script&lang=js\"\n\nimport \"./Pagination.vue?vue&type=style&index=0&id=0bddd3b0&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<template>\r\n  <div v-if=\"visible\" class=\"modal-overlay\" @click.self=\"close\">\r\n    <div\r\n      class=\"modal-content\"\r\n      ref=\"modalContent\"\r\n      @mousedown=\"startDrag\"\r\n      @mouseup=\"stopDrag\"\r\n      @mousemove=\"drag\"\r\n    >\r\n      <button class=\"modal-close\" @click=\"close\">×</button>\r\n      <div v-for=\"(msg, index) in messages\" :key=\"index\">\r\n        <p>{{ msg.nick }} : {{ msg.content }}</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, watch, computed } from \"vue\";\r\nimport axios from \"@/axios.js\";\r\n\r\nexport default {\r\n  props: {\r\n    modalValue: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    chatroomId: {\r\n      type: String,\r\n      default: \"\",\r\n    },\r\n  },\r\n  emits: [\"update:modalValue\", \"reset-chatroom-id\"],\r\n  setup(props, { emit }) {\r\n    const chatroomId = computed(() => props.chatroomId);\r\n    const visible = ref(props.modalValue);\r\n    const modalContent = ref(null);\r\n    let isDragging = ref(false);\r\n    let startX = 0;\r\n    let startY = 0;\r\n    let initialLeft = 0;\r\n    let initialTop = 0;\r\n    const message = ref(\"\");\r\n    let messages = ref([]);\r\n\r\n    // 대화내용 불러오기\r\n    const getMyChat = async () => {\r\n      try {\r\n        const response = await axios.post(\"/api/chat/chatList\", {\r\n          chatroomId: chatroomId.value,\r\n        });\r\n        messages.value = response.data;\r\n      } catch (error) {\r\n        console.error(\"Error fetching modal history list:\", error);\r\n      }\r\n    };\r\n    // 닫기\r\n    const close = () => {\r\n      chatroomId.value = \"\";\r\n      messages.value = [];\r\n      emit(\"update:modalValue\", false);\r\n      emit(\"reset-chatroom-id\");\r\n    };\r\n\r\n    //드래그 제어\r\n    const startDrag = (event) => {\r\n      isDragging.value = true;\r\n      startX = event.clientX;\r\n      startY = event.clientY;\r\n      const rect = modalContent.value.getBoundingClientRect();\r\n      initialLeft = rect.left;\r\n      initialTop = rect.top;\r\n    };\r\n    const stopDrag = () => {\r\n      isDragging.value = false;\r\n    };\r\n    const drag = (event) => {\r\n      if (!isDragging.value) return;\r\n      const dx = event.clientX - startX;\r\n      const dy = event.clientY - startY;\r\n      modalContent.value.style.left = `${initialLeft + dx}px`;\r\n      modalContent.value.style.top = `${initialTop + dy}px`;\r\n    };\r\n\r\n    watch(\r\n      () => props.modalValue,\r\n      (newValue) => {\r\n        visible.value = newValue;\r\n      }\r\n    );\r\n    watch(\r\n      () => chatroomId.value,\r\n      (newValue) => {\r\n        if (newValue) {\r\n          getMyChat();\r\n        }\r\n      }\r\n    );\r\n\r\n    return {\r\n      chatroomId,\r\n      visible,\r\n      close,\r\n      modalContent,\r\n      startDrag,\r\n      stopDrag,\r\n      drag,\r\n      message,\r\n      messages,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.modal-overlay {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.modal-content {\r\n  background: #fff;\r\n  border-radius: 8px;\r\n  padding: 20px;\r\n  position: absolute; /* 변경: absolute로 설정하여 드래그 시 이동 가능 */\r\n  cursor: move; /* 드래그 가능한 모양으로 변경 */\r\n  max-width: 500px;\r\n  width: 100%;\r\n}\r\n\r\n.modal-close {\r\n  position: absolute;\r\n  top: 10px;\r\n  right: 10px;\r\n  border: none;\r\n  background: none;\r\n  font-size: 20px;\r\n  cursor: pointer;\r\n}\r\n</style>\r\n","import { render } from \"./ChatHistoryModal.vue?vue&type=template&id=891b615c&scoped=true\"\nimport script from \"./ChatHistoryModal.vue?vue&type=script&lang=js\"\nexport * from \"./ChatHistoryModal.vue?vue&type=script&lang=js\"\n\nimport \"./ChatHistoryModal.vue?vue&type=style&index=0&id=891b615c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-891b615c\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"contentW\">\r\n    <ul>\r\n      <li class=\"tit\">채팅 이력</li>\r\n      <li class=\"navi\">\r\n        <ul>\r\n          <li>홈</li>\r\n          <li>채팅 이력</li>\r\n        </ul>\r\n      </li>\r\n    </ul>\r\n    <div>\r\n      <h1 class=\"dpn\">채팅 이력</h1>\r\n      <table class=\"tbl\">\r\n        <!-- 생성일, 답변자, 내용, 마지막 채팅일시 -->\r\n        <thead>\r\n          <tr>\r\n            <td class=\"wd6\">roomId</td>\r\n            <td class=\"wd12\">생성일</td>\r\n            <td class=\"wd12\">답변자</td>\r\n            <td>채팅</td>\r\n            <td class=\"wd12\">마지막 채팅일</td>\r\n            <td class=\"wd12\">상태(대기/진행중/완료)</td>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          <tr\r\n            v-for=\"chat in chatrooms?.slice(\r\n              pageStartIdx,\r\n              pageStartIdx + ITEM_PER_PAGE\r\n            )\"\r\n            :key=\"chat.chatroomId\"\r\n            @click=\"\r\n              chat.status === '03'\r\n                ? openChatHistoryModal(chat.chatroomId)\r\n                : openChatModal(chat.chatroomId)\r\n            \"\r\n          >\r\n            <td>{{ chat.chatroomId }}</td>\r\n            <td>{{ chat.credt }}</td>\r\n            <td class=\"wd10\">\r\n              {{\r\n                Array.isArray(chat.adm)\r\n                  ? chat.adm.map((a) => a.nick).join(\", \")\r\n                  : \"\"\r\n              }}\r\n            </td>\r\n            <td>\r\n              {{ chat.lastContent }}\r\n              <p v-if=\"unreadCounts[chat.chatroomId] != null\">\r\n                ( {{ unreadCounts[chat.chatroomId] }} )\r\n              </p>\r\n            </td>\r\n            <td>{{ chat.lastCredt }}</td>\r\n            <td>{{ chat.status }}</td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n      <Pagination\r\n        v-if=\"chatrooms.length > 0\"\r\n        :list=\"chatrooms\"\r\n        v-bind=\"{ ITEM_PER_PAGE, PAGE_PER_SECTION }\"\r\n        @change-page=\"onChangePage\"\r\n      />\r\n    </div>\r\n    <ChatHistoryModal\r\n      v-model:modalValue=\"isChatHistoryModalVisible\"\r\n      :chatroomId=\"chatroomId\"\r\n    />\r\n    <ChatModal\r\n      v-model:modelValue=\"isModalVisible\"\r\n      :userId=\"userId\"\r\n      :nick=\"nick\"\r\n      :role=\"role\"\r\n      :chatroomId=\"chatroomId\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, computed } from \"vue\";\r\nimport axios from \"@/axios.js\";\r\nimport ChatHistoryModal from \"./ChatHistoryModal.vue\";\r\nimport ChatModal from \"./ChatModal.vue\";\r\nimport Pagination from \"@/common/Pagination.vue\";\r\nimport { PAGING_CONFIG } from \"@/constant/constants.js\";\r\nimport { useChatStore } from \"@/stores/chatStore\";\r\nimport { sendWebSocket, getWebSocket } from \"@/common/websocketManager.js\";\r\n\r\nexport default {\r\n  components: { ChatHistoryModal, ChatModal, Pagination },\r\n  setup() {\r\n    const chatStore = useChatStore();\r\n    const userId = ref(localStorage.getItem(\"id\"));\r\n    const nick = ref(localStorage.getItem(\"nick\"));\r\n    const role = ref(\"USR\");\r\n    const chatrooms = computed(() => chatStore.chatList);\r\n    const unreadCounts = computed(() => chatStore.unreadCounts);\r\n    const chatroomId = ref(\"\");\r\n    const isChatHistoryModalVisible = ref(false);\r\n    const isModalVisible = ref(false);\r\n\r\n    const ITEM_PER_PAGE = ref(PAGING_CONFIG.ITEM_PER_PAGE);\r\n    const PAGE_PER_SECTION = ref(PAGING_CONFIG.PAGE_PER_SECTION);\r\n    let curPage = ref(1);\r\n\r\n    const pageStartIdx = computed(() => {\r\n      return (curPage.value - 1) * ITEM_PER_PAGE.value;\r\n    });\r\n\r\n    const onChangePage = (data) => {\r\n      curPage.value = data;\r\n    };\r\n\r\n    // 채팅 리스트 가져오기 함수\r\n    const getMyChatroomList = async () => {\r\n      try {\r\n        const response = await axios.post(\"/api/chat/chatroomList\", {\r\n          id: userId.value,\r\n        });\r\n        //chatrooms.value = response.data;\r\n        // pinia\r\n        chatStore.setChatList(response.data);\r\n      } catch (error) {\r\n        console.error(\"Error fetching usr chat list:\", error);\r\n      }\r\n    };\r\n\r\n    // 채팅창 열기\r\n    const openChatHistoryModal = (id) => {\r\n      chatroomId.value = id;\r\n      isChatHistoryModalVisible.value = true;\r\n    };\r\n\r\n    const openChatModal = (id) => {\r\n      chatroomId.value = id;\r\n      isModalVisible.value = true;\r\n      chatStore.markAsRead(id);\r\n    };\r\n\r\n    function waitWebSocketOpen(socket) {\r\n      return new Promise((resolve) => {\r\n        if (socket.readyState === WebSocket.OPEN) {\r\n          resolve();\r\n        } else {\r\n          socket.addEventListener(\"open\", resolve, { once: true });\r\n        }\r\n      });\r\n    }\r\n\r\n    onMounted(async () => {\r\n      // 리스트 최신화\r\n      await getMyChatroomList();\r\n      // 채팅방 복구\r\n      const socket = getWebSocket();\r\n      await waitWebSocketOpen(socket);\r\n\r\n      const rids = chatStore.chatList\r\n        .filter((r) => r.status === \"02\")\r\n        .map((r) => r.chatroomId);\r\n\r\n      rids.forEach((rid) => {\r\n        const sendBody = {\r\n          chatroomId: rid,\r\n          type: \"REJOIN\",\r\n        };\r\n        sendWebSocket(sendBody);\r\n      });\r\n    });\r\n\r\n    return {\r\n      userId,\r\n      nick,\r\n      role,\r\n      chatrooms,\r\n      unreadCounts,\r\n      chatroomId,\r\n      isChatHistoryModalVisible,\r\n      isModalVisible,\r\n      openChatHistoryModal,\r\n      openChatModal,\r\n      ITEM_PER_PAGE,\r\n      PAGE_PER_SECTION,\r\n      pageStartIdx,\r\n      onChangePage,\r\n    };\r\n  },\r\n};\r\n</script>\r\n","import { render } from \"./ChatList.vue?vue&type=template&id=4f288f36\"\nimport script from \"./ChatList.vue?vue&type=script&lang=js\"\nexport * from \"./ChatList.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["style","_createElementBlock","_hoisted_1","_ctx","leftmostPage","$props","PAGE_PER_SECTION","_hoisted_2","_createElementVNode","onClick","_cache","onChangeCurPage","_Fragment","_renderList","getPaginationArray","page","class","key","_normalizeClass","on","curPage","_hoisted_3","totalPage","_hoisted_4","props","list","Array","ITEM_PER_PAGE","Number","emits","setup","emit","usePagination","ref","Math","ceil","length","left","res","i","min","push","value","__exports__","render","$setup","visible","_withModifiers","args","close","onMousedown","startDrag","onMouseup","stopDrag","onMousemove","drag","messages","msg","index","_toDisplayString","nick","content","modalValue","type","Boolean","default","chatroomId","String","computed","modalContent","isDragging","startX","startY","initialLeft","initialTop","message","getMyChat","async","response","axios","post","data","error","console","event","clientX","clientY","rect","getBoundingClientRect","top","dx","dy","watch","newValue","chatrooms","slice","pageStartIdx","chat","$event","status","openChatHistoryModal","openChatModal","credt","isArray","adm","map","a","join","lastContent","unreadCounts","_hoisted_5","lastCredt","_createBlock","_component_Pagination","_mergeProps","onChangePage","_createVNode","_component_ChatHistoryModal","isChatHistoryModalVisible","_component_ChatModal","modelValue","isModalVisible","userId","role","components","ChatHistoryModal","ChatModal","Pagination","chatStore","useChatStore","localStorage","getItem","chatList","PAGING_CONFIG","getMyChatroomList","id","setChatList","markAsRead","waitWebSocketOpen","socket","Promise","resolve","readyState","WebSocket","OPEN","addEventListener","once","onMounted","getWebSocket","rids","filter","r","forEach","rid","sendBody","sendWebSocket"],"sourceRoot":""}