"use strict";(self["webpackChunktest1"]=self["webpackChunktest1"]||[]).push([[562],{3173:function(t,a,o){var l=o(4373);const e=l.A.create({baseURL:"http://localhost:9091"});e.interceptors.request.use((t=>{const a=localStorage.getItem("jwt");return a&&(t.headers.Authorization=`Bearer ${a}`),t}),(t=>Promise.reject(t))),a.A=e},8562:function(t,a,o){o.r(a),o.d(a,{default:function(){return p}});var l=o(6768),e=o(4232);const s={class:"contentW"},n={class:"tbl"},r=["onClick"],d={class:"wd10"},c={class:"wd10"},i={key:0};function u(t,a,o,u,h,k){const m=(0,l.g2)("Pagination"),I=(0,l.g2)("ChatHistoryModal"),E=(0,l.g2)("ChatModal");return(0,l.uX)(),(0,l.CE)("div",s,[a[4]||(a[4]=(0,l.Lk)("ul",null,[(0,l.Lk)("li",{class:"tit"},"내 채팅"),(0,l.Lk)("li",{class:"navi"},[(0,l.Lk)("ul",null,[(0,l.Lk)("li",null,"홈"),(0,l.Lk)("li",null,"내 채팅")])])],-1)),(0,l.Lk)("div",null,[a[3]||(a[3]=(0,l.Lk)("h1",{class:"dpn"},"내 채팅",-1)),(0,l.Lk)("table",n,[a[2]||(a[2]=(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("td",{class:"wd6"},"rId"),(0,l.Lk)("td",{class:"wd12"},"생성일"),(0,l.Lk)("td",{class:"wd10"},"답변자"),(0,l.Lk)("td",{class:"wd10"},"문의자"),(0,l.Lk)("td",null,"채팅"),(0,l.Lk)("td",{class:"wd12"},"마지막 채팅일"),(0,l.Lk)("td",{class:"wd10"},"상태(대기/진행중/완료)")])],-1)),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(u.chatrooms?.slice(u.pageStartIdx,u.pageStartIdx+u.ITEM_PER_PAGE),(t=>((0,l.uX)(),(0,l.CE)("tr",{key:t.chatroomId,onClick:a=>"02"===t.status?u.openChatModal(t.chatroomId):u.openChatHistoryModal(t.chatroomId)},[(0,l.Lk)("td",null,(0,e.v_)(t.chatroomId),1),(0,l.Lk)("td",null,(0,e.v_)(t.credt),1),(0,l.Lk)("td",d,(0,e.v_)(Array.isArray(t.adm)?t.adm.map((t=>t.nick)).join(", "):""),1),(0,l.Lk)("td",c,(0,e.v_)(t.usr?.nick||""),1),(0,l.Lk)("td",null,[(0,l.eW)((0,e.v_)(t.lastContent)+" ",1),null!=u.unreadCounts[t.chatroomId]?((0,l.uX)(),(0,l.CE)("p",i," ( "+(0,e.v_)(u.unreadCounts[t.chatroomId])+" ) ",1)):(0,l.Q3)("",!0)]),(0,l.Lk)("td",null,(0,e.v_)(t.lastCredt),1),(0,l.Lk)("td",null,(0,e.v_)(t.status),1)],8,r)))),128))])]),u.chatrooms.length>0?((0,l.uX)(),(0,l.Wv)(m,(0,l.v6)({key:0,list:u.chatrooms},{ITEM_PER_PAGE:u.ITEM_PER_PAGE,PAGE_PER_SECTION:u.PAGE_PER_SECTION},{onChangePage:u.onChangePage}),null,16,["list","onChangePage"])):(0,l.Q3)("",!0)]),(0,l.bF)(I,{modalValue:u.isChatHistoryModalVisible,"onUpdate:modalValue":a[0]||(a[0]=t=>u.isChatHistoryModalVisible=t),chatroomId:u.chatroomId},null,8,["modalValue","chatroomId"]),(0,l.bF)(E,{modelValue:u.isModalVisible,"onUpdate:modelValue":a[1]||(a[1]=t=>u.isModalVisible=t),userId:u.userId,nick:u.nick,role:u.role,chatroomId:u.chatroomId},null,8,["modelValue","userId","nick","role","chatroomId"])])}var h=o(144),k=o(3173),m=o(124),I=o(5530),E=o(9383),C=o(1102),L=o(5897),v=o(7203),P={components:{ChatHistoryModal:m.A,ChatModal:I.A,Pagination:E.A},setup(){const t=(0,h.KR)(localStorage.getItem("adminId")),a=(0,h.KR)(localStorage.getItem("adminNick")),o=(0,h.KR)("ADM"),e=(0,L.L)(),s=(0,l.EW)((()=>e.chatList)),n=(0,l.EW)((()=>e.unreadCounts)),r=(0,h.KR)(""),d=(0,h.KR)(!1),c=(0,h.KR)(!1),i=(0,h.KR)(C.y.ITEM_PER_PAGE),u=(0,h.KR)(C.y.PAGE_PER_SECTION);let m=(0,h.KR)(1);const I=(0,l.EW)((()=>(m.value-1)*i.value)),E=t=>{m.value=t},P=async()=>{try{const a=await k.A.post("/api/admin/chat/mylist",{id:t.value});e.setChatList(a.data)}catch(a){console.error("Error fetching chat list:",a),console.log(a)}},_=t=>{r.value=t,d.value=!0},g=t=>{r.value=t,c.value=!0,e.markAsRead(t)},p=()=>{r.value=""};function y(t){return new Promise((a=>{t.readyState===WebSocket.OPEN?a():t.addEventListener("open",a,{once:!0})}))}return(0,l.sV)((async()=>{await P();const t=(0,v.mn)();await y(t);const a=e.chatList.filter((t=>"02"===t.status)).map((t=>t.chatroomId));a.forEach((t=>{const a={chatroomId:t,type:"REJOIN"};(0,v.wI)(a)}))})),{userId:t,nick:a,role:o,chatrooms:s,unreadCounts:n,chatroomId:r,isChatHistoryModalVisible:d,isModalVisible:c,openChatHistoryModal:_,openChatModal:g,resetChatroomId:p,ITEM_PER_PAGE:i,PAGE_PER_SECTION:u,pageStartIdx:I,onChangePage:E}}},_=o(1241);const g=(0,_.A)(P,[["render",u]]);var p=g}}]);
//# sourceMappingURL=562.26d5af2e.js.map