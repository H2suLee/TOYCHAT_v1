(function(){"use strict";var e={3173:function(e,t,n){var o=n(4373);const a=o.A.create({baseURL:"http://localhost:9091"});a.interceptors.request.use((e=>{const t=localStorage.getItem("jwt");return t&&(e.headers.Authorization=`Bearer ${t}`),e}),(e=>(console.log("에러발생 : ",e),Promise.reject(e)))),t.A=a},7203:function(e,t,n){n.d(t,{SR:function(){return c},ST:function(){return u},a1:function(){return i},mn:function(){return s},wI:function(){return l}});n(3375),n(9225),n(3972),n(9209),n(5714),n(7561),n(6197);var o=n(5897);let a=null;const r=new Set;function i(){a||(a=new WebSocket("ws://localhost:9090/ws/chat"),a.onopen=()=>{console.log("전역 Websocket open")},a.onmessage=e=>{let t=JSON.parse(e.data);const n=(0,o.L)();"TYPING"!=t.type&&"STOP"!=t.type&&n.handleIncomingMessage(t),r.forEach((e=>e(t)))},a.onclose=()=>{console.warn("전역 WebSocket closed. Reconnecting in 3s..."),a=null,setTimeout(i,1e3)},a.onerror=e=>{console.error("전역 WebSocket error",e)})}function s(){return a}function l(e){a&&a.readyState===WebSocket.OPEN&&a.send(JSON.stringify(e))}function c(e){r.add(e)}function u(e){r.delete(e)}},1102:function(e,t,n){n.d(t,{V:function(){return a},y:function(){return o}});const o={ITEM_PER_PAGE:5,PAGE_PER_SECTION:10},a=3600},6017:function(e,t,n){var o=n(595);const a=(0,o.A)();t.A=a},9997:function(e,t,n){var o=n(5130),a=n(6768);const r={key:0},i={key:1},s={key:1},l={key:1};function c(e,t,n,o,c,u){const d=(0,a.g2)("Login"),m=(0,a.g2)("Header"),h=(0,a.g2)("LeftMenu"),p=(0,a.g2)("router-view"),g=(0,a.g2)("AdminLogin"),f=(0,a.g2)("AdminHeader"),k=(0,a.g2)("AdminLeftMenu");return(0,a.uX)(),(0,a.CE)("div",null,[o.isAdmin?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",r,[(0,a.Lk)("div",null,[o.isLogin?((0,a.uX)(),(0,a.CE)("div",i,[(0,a.bF)(m),(0,a.bF)(h),(0,a.bF)(p)])):((0,a.uX)(),(0,a.Wv)(d,{key:0}))]),o.isOauthCallback?((0,a.uX)(),(0,a.Wv)(p,{key:0})):(0,a.Q3)("",!0)])),o.isAdmin?((0,a.uX)(),(0,a.CE)("div",s,[(0,a.Lk)("div",null,[o.isLogin?((0,a.uX)(),(0,a.CE)("div",l,[(0,a.bF)(f),(0,a.bF)(k),(0,a.bF)(p)])):((0,a.uX)(),(0,a.Wv)(g,{key:0}))])])):(0,a.Q3)("",!0)])}n(4979);var u=n(144),d=n(973),m=n(4232),h=n.p+"img/logomini.8cb619d3.svg",p=n.p+"img/userlogin.4e568785.svg",g=n.p+"img/userlogout.7b94e9ed.svg";const f={class:"header"},k={class:"dpf"},v={class:"em"},L={class:"chatW"},b={class:"chatHd"},y={key:0,class:"impsbChat"},C={key:1,class:"psbChat"};function A(e,t,n,o,r,i){const s=(0,a.g2)("ChatModal");return(0,a.uX)(),(0,a.CE)("div",f,[t[12]||(t[12]=(0,a.Lk)("h1",null,[(0,a.Lk)("img",{src:h,alt:"TOYCHATLOGO"})],-1)),(0,a.Lk)("ul",k,[(0,a.Lk)("li",null,[t[3]||(t[3]=(0,a.Lk)("img",{src:p,alt:"사람 모양의 아이콘"},null,-1)),(0,a.Lk)("span",v,(0,m.v_)(o.nick),1),t[4]||(t[4]=(0,a.eW)("  님   접속중 "))]),(0,a.Lk)("li",null,(0,m.v_)(o.sessionTime),1),(0,a.Lk)("li",null,[(0,a.Lk)("a",{onClick:t[0]||(t[0]=(...e)=>o.fn_kakaoLogout&&o.fn_kakaoLogout(...e))},t[5]||(t[5]=[(0,a.Lk)("img",{src:g,alt:"로그아웃 아이콘"},null,-1),(0,a.eW)("로그아웃")]))]),(0,a.Lk)("li",null,[(0,a.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>o.openChatModal&&o.openChatModal(...e))},t[6]||(t[6]=[(0,a.Lk)("div",{class:"roadBox",title:"채팅을 시작하려면 클릭해주세요!"},[(0,a.Lk)("span",{class:"circle circle1"}),(0,a.Lk)("span",{class:"circle circle2"}),(0,a.Lk)("span",{class:"circle circle3"})],-1)]))])]),(0,a.bF)(s,{ref:"chatModal",modelValue:o.isModalVisible,"onUpdate:modelValue":t[2]||(t[2]=e=>o.isModalVisible=e),userId:o.userId,nick:o.nick,role:o.role,chatroomId:o.chatroomId,onResetChatroomId:o.resetChatroomId},{default:(0,a.k6)((()=>[t[11]||(t[11]=(0,a.Lk)("h2",{class:"dpn"},"대화",-1)),(0,a.Lk)("div",L,[(0,a.Lk)("ul",b,[t[10]||(t[10]=(0,a.Lk)("li",null,"질문이 있으신가요? 지금 문의하세요!",-1)),(0,a.Lk)("li",null,[o.isActivAdmin?((0,a.uX)(),(0,a.CE)("div",C,[t[8]||(t[8]=(0,a.Lk)("p",null,"온라인 문의가 가능한 상태입니다.",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.activeAdmin,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t},(0,m.v_)(e),1)))),128)),t[9]||(t[9]=(0,a.Lk)("p",{class:"agentChat"},"안녕하세요! 어떻게 도와드릴까요?",-1))])):((0,a.uX)(),(0,a.CE)("div",y,t[7]||(t[7]=[(0,a.Lk)("p",{class:"timeAlert"},[(0,a.eW)(" 오전 10시부터 오후 6시까지"),(0,a.Lk)("span",{class:"dpn"},"가능한 상담원이 없습니다.")],-1)])))])])])])),_:1},8,["modelValue","userId","nick","role","chatroomId","onResetChatroomId"])])}n(4114),n(4603),n(7566),n(8721);var w=n(6598),I=n(3173),S=n(6017),E=n(1102),_=n(7203),T=n(5897),R={components:{ChatModal:w.A},setup(){const e=(0,d.rd)(),t=(0,u.KR)(localStorage.getItem("id")),o=(0,u.KR)(localStorage.getItem("nick")),r=(0,u.KR)("USR"),i=(0,u.KR)(!1),s=(0,u.KR)(localStorage.getItem("chatroomId"));let l=null;const c=(0,u.KR)([]),m=(0,u.KR)(!1),h=(0,u.KR)("");let p=null;const g=(0,T.L)(),f=()=>{window.Kakao.Auth.logout((t=>{t&&(localStorage.clear(),g.resetStore(),e.push("/"),window.location.reload())}))},k=()=>{s.value="",console.log("header에서 emit 받음")},v=()=>{""==s.value?I.A.post("/api/chat/create",{id:t.value,nick:o.value}).then((e=>{s.value=e.data.chatroomId,i.value=!0})):i.value=!0},L=()=>{l=new WebSocket("ws://localhost:9090/ws/adminOnList?role=usr"),l.onopen=()=>{console.log("activeAdminChkSocket connection opened")},l.onmessage=e=>{console.log("activeAdminChkSocket got message");let t=e.data,n=t.split(",");c.value=n,m.value=c.value[0].length>0},l.onclose=()=>{console.log("activeAdminChkSocket connection closed")},l.onerror=e=>{console.error("activeAdminChkSocket error: ",e)}},b=()=>{"undefined"!=typeof Worker?(p||(p=new Worker(new URL(n.p+n.u(954),n.b),{type:void 0}),p.addEventListener("message",(function(e){var t=e.data;if("tick"==t.type){var n=Math.floor(t.remainingTime/60),o=t.remainingTime%60,a=y(2,n.toString())+" : "+y(2,o.toString());h.value=a}else"timeout"==t.type&&(console.log("세션타임아웃"),f())}))),p.postMessage({command:"reset",timeoutSeconds:E.V}),console.log("끝")):console.log("Your browser doesn't support web workers.")},y=(e,t)=>t.length>=e?t:new Array(e-t.length+1).join("0")+t;return(0,a.sV)((()=>{console.log("header monuted"),(0,_.a1)(),L(),S.A.on("reset-chatroom-id",k),b()})),(0,a.hi)((()=>{l&&l.close(),p&&(p.terminate(),p=null)})),(0,a.xo)((()=>{S.A.off("reset-chatroom-id",k)})),(0,a.wB)(s,(e=>{localStorage.setItem("chatroomId",e)})),{router:e,userId:t,nick:o,role:r,isModalVisible:i,chatroomId:s,activeAdmin:c,isActivAdmin:m,openChatModal:v,openActiveAdminChkSocket:L,resetChatroomId:k,sessionTime:h,fn_kakaoLogout:f}}},M=n(1241);const W=(0,M.A)(R,[["render",A]]);var K=W,O=n.p+"img/chatlist.002fcb5e.svg";const P={class:"leftMenu"};function N(e,t){const n=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",P,[t[2]||(t[2]=(0,a.Lk)("p",{class:"dpn"},"왼쪽메뉴",-1)),(0,a.Lk)("ul",null,[(0,a.Lk)("li",null,[(0,a.bF)(n,{to:"/chat/list","active-class":"on"},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.Lk)("img",{src:O,alt:"채팅 이력 아이콘"},null,-1),(0,a.eW)("채팅 이력 ")]))),_:1,__:[0]})]),(0,a.Lk)("li",null,[(0,a.bF)(n,{to:"/chat/paginationTest","active-class":"on"},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.Lk)("img",{src:O,alt:"채팅 이력 아이콘"},null,-1),(0,a.eW)("페이징 테스트 ")]))),_:1,__:[1]})])])])}const X={},j=(0,M.A)(X,[["render",N]]);var U=j;const B={class:"bg"};function D(e,t,n,o,r,i){return(0,a.uX)(),(0,a.CE)("div",B,t[0]||(t[0]=[(0,a.Lk)("p",null,"TOYCHAT",-1),(0,a.Lk)("a",{href:"http://localhost:9090/oauth2/authorization/kakao"},[(0,a.Lk)("img",{src:"//k.kakaocdn.net/14/dn/btqCn0WEmI3/nijroPfbpCa4at5EIsjyf0/o.jpg",width:"222"})],-1),(0,a.Lk)("a",{href:"http://localhost:9090/oauth2/authorization/github"}," 깃허브로그인 />",-1)]))}var F={methods:{fn_kakaoLogin(){window.Kakao.Auth.login({scope:"profile_nickname",success:this.fn_getKakaoAccount})},fn_getKakaoAccount(){window.Kakao.API.request({url:"/v2/user/me",success:e=>{var t=e.id,n=e.kakao_account.profile.nickname;localStorage.setItem("isAuthenticated",!0),localStorage.setItem("id",t),localStorage.setItem("nick",n),localStorage.setItem("role","USR"),this.$router.go("/")},fail:e=>{console.log(e),localStorage.setItem("isAuthenticated",!1)}})}}};const V=(0,M.A)(F,[["render",D]]);var H=V,x=n(9730);const q={class:"header"},Y={class:"dpf"},G={class:"em"};function $(e,t,n,o,r,i){return(0,a.uX)(),(0,a.CE)("div",q,[t[4]||(t[4]=(0,a.Lk)("h1",null,[(0,a.Lk)("img",{src:h,alt:"TOYCHATLOGO"}),(0,a.eW)(" 관리자 ")],-1)),(0,a.Lk)("ul",Y,[(0,a.Lk)("li",null,[t[1]||(t[1]=(0,a.Lk)("img",{src:p,alt:"사람 모양의 아이콘"},null,-1)),(0,a.Lk)("span",G,(0,m.v_)(o.nick),1),t[2]||(t[2]=(0,a.eW)("  님   접속중 "))]),(0,a.Lk)("li",null,(0,m.v_)(o.sessionTime),1),(0,a.Lk)("li",null,[(0,a.Lk)("a",{onClick:t[0]||(t[0]=(...e)=>o.handleLogout&&o.handleLogout(...e))},t[3]||(t[3]=[(0,a.Lk)("img",{src:g,alt:"로그아웃 아이콘"},null,-1),(0,a.eW)("로그아웃")]))])])])}var z=n(6400),Q=n(7530),J={setup(){const e=(0,d.rd)(),t=(0,u.KR)(localStorage.getItem("adminNick")),o=(0,u.KR)("");let r=null;const i=(0,T.L)(),s=()=>{e.push("/admin"),localStorage.clear(),i.resetStore(),window.location.reload()},l={apiKey:"AIzaSyBUochlrZu3cwXnaW907_ZvHPPNQkCHUaE",authDomain:"toychat-1a2b7.firebaseapp.com",projectId:"toychat-1a2b7",storageBucket:"toychat-1a2b7.appspot.com",messagingSenderId:"286624352269",appId:"1:286624352269:web:c05c71880d215786ea2d44",measurementId:"G-8LWB2ZRCW1"},c=(0,z.Wp)(l),m=(0,Q.dG)(c);(0,Q.xD)(m,(e=>{console.log("Message received. ",e)})),Notification.requestPermission().then((e=>{"granted"===e||alert("Unable to get permission to notify.")}));const h="BB-jj2EArj_qbaSA6eCicuMBbt9CnaErLl7hHthN1M3UQif7XpnA6jQpiQ2ShqMmWCBX9zWbN_0F903c8K4NRwo",p=()=>{console.log(h),(0,Q.gf)(m,{vapidKey:h}).then((e=>{if(console.log("current Token?"),e)try{let t=localStorage.getItem("adminId");I.A.post("/api/fcm/createKey",{fcmKey:e,id:t})}catch(t){console.error("Error fetching token:",t)}else console.log("No registration token available. Request permission to generate one.")})).catch((e=>{console.log("An error occurred while retrieving token. ",e)}))},g=()=>{"undefined"!=typeof Worker?(r||(r=new Worker(new URL(n.p+n.u(573),n.b),{type:void 0}),r.addEventListener("message",(function(e){var t=e.data;if("tick"==t.type){var n=Math.floor(t.remainingTime/60),a=t.remainingTime%60,r=f(2,n.toString())+" : "+f(2,a.toString());o.value=r}else"timeout"==t.type&&(alert("세션 타임 아웃"),s())}))),r.postMessage({command:"reset",timeoutSeconds:E.V}),console.log("끝")):console.log("Your browser doesn't support web workers.")},f=(e,t)=>t.length>=e?t:new Array(e-t.length+1).join("0")+t;return(0,a.sV)((()=>{(0,_.a1)(),p(),g()})),(0,a.hi)((()=>{r&&(r.terminate(),r=null)})),{nick:t,handleLogout:s,sessionTime:o}}};const Z=(0,M.A)(J,[["render",$]]);var ee=Z;const te={class:"leftMenu"};function ne(e,t){const n=(0,a.g2)("router-link");return(0,a.uX)(),(0,a.CE)("div",te,[t[3]||(t[3]=(0,a.Lk)("p",{class:"dpn"},"왼쪽메뉴",-1)),(0,a.Lk)("ul",null,[(0,a.Lk)("li",null,[(0,a.bF)(n,{to:"/admin/chat/mnglist","active-class":"on"},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.Lk)("img",{src:O,alt:"채팅 이력 아이콘"},null,-1),(0,a.eW)("완료채팅관리 ")]))),_:1,__:[0]})]),(0,a.Lk)("li",null,[(0,a.bF)(n,{to:"/admin/chat/serviceList","active-class":"on"},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.Lk)("img",{src:O,alt:"채팅 이력 아이콘"},null,-1),(0,a.eW)("실시간 채팅 지원 ")]))),_:1,__:[1]})]),(0,a.Lk)("li",null,[(0,a.bF)(n,{to:"/admin/chat/myList","active-class":"on"},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.Lk)("img",{src:O,alt:"채팅 이력 아이콘"},null,-1),(0,a.eW)("내 채팅 ")]))),_:1,__:[2]})])])])}const oe={},ae=(0,M.A)(oe,[["render",ne]]);var re=ae;const ie={class:"bg"},se={class:"login"},le={key:0,class:"error"};function ce(e,t,n,r,i,s){return(0,a.uX)(),(0,a.CE)("div",ie,[(0,a.Lk)("div",se,[t[6]||(t[6]=(0,a.Lk)("h1",null,"Login",-1)),(0,a.Lk)("form",{onSubmit:t[2]||(t[2]=(0,o.D$)(((...e)=>s.handleLogin&&s.handleLogin(...e)),["prevent"]))},[(0,a.Lk)("div",null,[t[3]||(t[3]=(0,a.Lk)("label",{for:"username"},"Id:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>i.id=e),id:"id",required:""},null,512),[[o.Jo,i.id]])]),(0,a.Lk)("div",null,[t[4]||(t[4]=(0,a.Lk)("label",{for:"password"},"Password:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>i.password=e),id:"password",required:""},null,512),[[o.Jo,i.password]])]),t[5]||(t[5]=(0,a.Lk)("button",{type:"submit"},"Login",-1)),i.error?((0,a.uX)(),(0,a.CE)("div",le,(0,m.v_)(i.error),1)):(0,a.Q3)("",!0)],32)])])}var ue=n(4373),de={data(){return{id:"",password:"",error:""}},methods:{async handleLogin(){try{const e=await ue.A.post("/api/admin/login",{id:this.id,pw:this.password}),t=e.data.jwt,n=e.data.nick;localStorage.setItem("jwt",t),localStorage.setItem("adminNick",n),localStorage.setItem("adminId",this.id),localStorage.setItem("isAuthenticated",!0),console.log("성공"),this.$router.go("/admin")}catch(e){console.error(e),this.error="Login failed: "+(e.response?.data?.message||"Unknown error"),localStorage.setItem("isAuthenticated",!1)}}}};const me=(0,M.A)(de,[["render",ce],["__scopeId","data-v-0d34be6b"]]);var he=me,pe=n(7463),ge={name:"App",components:{Header:K,LeftMenu:U,Login:H,AdminHeader:ee,AdminLeftMenu:re,AdminLogin:he,Home:x["default"],AdminHome:pe["default"]},setup(){(0,d.lq)();const e=(0,d.rd)(),t=(0,u.KR)(null),n=(0,u.KR)(null),o=(0,u.KR)(null),a=async()=>{const e="true"===localStorage.getItem("isAuthenticated");let n=!1;const o=localStorage.getItem("jwt");if(o)try{const e=JSON.parse(atob(o.split(".")[1])),t=e.exp&&Date.now()/1e3>e.exp;n=!t}catch(a){n=!1}return t.value?n:e};return e.afterEach((async(e,r)=>{t.value=e.path.startsWith("/admin"),o.value=e.path.startsWith("/login/oauth2"),n.value=await a()})),{isAdmin:t,isLogin:n,isOauthCallback:o}}};const fe=(0,M.A)(ge,[["render",c]]);var ke=fe;const ve=[{path:"/",name:"Home",component:()=>Promise.resolve().then(n.bind(n,9730))},{path:"/chat/list",name:"ChatList",component:()=>n.e(242).then(n.bind(n,9242))},{path:"/chat/paginationTest",name:"PaginationTest",component:()=>n.e(489).then(n.bind(n,1489))},{path:"/admin",name:"AdminHome",component:()=>Promise.resolve().then(n.bind(n,7463))},{path:"/admin/chat/mnglist",name:"AdminChatManage",component:()=>n.e(687).then(n.bind(n,4687))},{path:"/admin/chat/serviceList",name:"AdminChatService",component:()=>n.e(961).then(n.bind(n,6961))},{path:"/admin/chat/myList",name:"AdminMyChatManage",component:()=>n.e(940).then(n.bind(n,1940))},{path:"/admin/chat/empty",name:"AdminEmpty",component:()=>n.e(913).then(n.bind(n,2913))},{path:"/login/oauth2/callback",name:"LoginCallback",component:()=>n.e(577).then(n.bind(n,1577))}],Le=(0,d.aE)({history:(0,d.LA)(),routes:ve});var be=Le,ye=n(2261),Ce=n(5827);const Ae=(0,o.Ef)(ke).use(be),we=(0,ye.Ey)();we.use(Ce.A),Ae.config.globalProperties.$axios=ue.A,Ae.use(we),Ae.mount("#app")},5897:function(e,t,n){n.d(t,{L:function(){return a}});n(4114);var o=n(2261);const a=(0,o.nY)("chat",{state:()=>({chatList:[],unreadCounts:{}}),actions:{handleIncomingMessage(e){const t=this.chatList.find((t=>t.chatroomId===e.chatroomId));if(t){var n={...t,lastContent:e.content,lastCredt:e.credt,status:"END"===e.type?"03":t.adm?"02":"01"};"ENTER"===e.type&&"ADM"===e.role&&n.adm.push({nick:e.nick}),this.chatList=[n,...this.chatList.filter((t=>t.chatroomId!==e.chatroomId))]}else{n={chatroomId:e.chatroomId,credt:e.credt,usr:{id:e.id,nick:e.nick},adm:[],lastContent:e.content,lastCredt:e.credt,status:"01"};this.chatList.unshift(n)}this.unreadCounts[e.chatroomId]=(this.unreadCounts[e.chatroomId]||0)+1},markAsRead(e){console.log("markAsRead : "+e),this.unreadCounts[e]=0},setChatList(e){this.chatList=e},resetStore(){this.chatList=[],this.unreadCounts={}}},persist:{key:"chat-store",storage:localStorage,paths:["chatList","unreadCounts"]}})},7463:function(e,t,n){n.r(t),n.d(t,{default:function(){return l}});var o=n(6768);function a(e,t){return(0,o.uX)(),(0,o.CE)("div")}var r=n(1241);const i={},s=(0,r.A)(i,[["render",a]]);var l=s},6598:function(e,t,n){n.d(t,{A:function(){return v}});var o=n(6768),a=n(5130),r=n(4232),i=n.p+"img/send.cc05441e.svg";const s={class:"userChatBox"},l={key:0},c={class:"inputMsg"};function u(e,t,n,u,d,m){return(0,o.bo)(((0,o.uX)(),(0,o.CE)("div",{class:"modal-overlay",onClick:t[8]||(t[8]=(0,a.D$)(((...e)=>u.minimize&&u.minimize(...e)),["self"]))},[(0,o.Lk)("div",{class:"modal-content",ref:"modalContent",onMousedown:t[5]||(t[5]=(...e)=>u.startDrag&&u.startDrag(...e)),onMouseup:t[6]||(t[6]=(...e)=>u.stopDrag&&u.stopDrag(...e)),onMousemove:t[7]||(t[7]=(...e)=>u.drag&&u.drag(...e))},[(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>u.minimize&&u.minimize(...e)),style:{padding:"1.6rem"}},"최소화"),(0,o.Lk)("button",{class:"modal-close",onClick:t[1]||(t[1]=(...e)=>u.close&&u.close(...e))}),(0,o.RG)(e.$slots,"default",{},void 0,!0),(0,o.Lk)("div",s,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(u.messages,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t},[(0,o.Lk)("div",{class:(0,r.C4)(e.id===u.userId?"message me":"message other")},[(0,o.Lk)("p",null,(0,r.v_)(e.nick)+" : "+(0,r.v_)(e.content),1)],2)])))),128))]),u.typingUsers.length>0?((0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("p",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(u.typingUsers,((e,t)=>((0,o.uX)(),(0,o.CE)("span",{key:t},(0,r.v_)(t>0?",":"")+" "+(0,r.v_)(e),1)))),128)),t[9]||(t[9]=(0,o.eW)(" 님이 작성중입니다... "))])])):(0,o.Q3)("",!0),(0,o.Lk)("div",c,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>u.message=e),onKeydown:t[3]||(t[3]=(...e)=>u.keyupAction&&u.keyupAction(...e)),placeholder:"메시지 작성.."},null,544),[[a.Jo,u.message]]),(0,o.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>u.sendMessage&&u.sendMessage(...e)),class:"sendBtn"},t[10]||(t[10]=[(0,o.Lk)("img",{src:i,alt:"전송 버튼 아이콘"},null,-1)]))])],544)],512)),[[a.aG,u.visible]])}n(4114);var d=n(144),m=n(3173),h=n(6017),p=n(7203),g={props:{modelValue:{type:Boolean,default:!1},userId:{type:String,default:""},nick:{type:String,default:""},role:{type:String,default:""},chatroomId:{type:String,default:""}},methods:{closeChatroom(){closeProcess()}},setup(e,{emit:t}){const n=(0,o.EW)((()=>e.userId)),a=(0,o.EW)((()=>e.nick)),r=(0,o.EW)((()=>e.role)),i=(0,o.EW)((()=>e.chatroomId)),s=(0,d.KR)(e.modelValue),l=(0,d.KR)(null),c=(0,d.KR)(!1);let u=0,g=0,f=0,k=0;const v=(0,d.KR)(""),L=(0,d.KR)([]);let b=null;const y=(0,d.KR)([]),C=["Shift","Control","Alt","CapsLock","Escape","PageUp","PageDown","End","Home","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","Insert","Delete","Meta","Tab"];function A(e){const t=e.type;if("TYPING"==t)y.value.includes(e.nick)||e.nick==a.value||y.value.push(e.nick);else if("STOP"==t)y.value=y.value.filter((t=>t!==e.nick));else{const t={id:e.id,nick:e.nick,content:e.content};L.value.push(t)}}const w=e=>{let t="ENTER"===e?`${a.value}님이 입장하였습니다.`:"END"===e?"대화가 종료되었습니다.":v.value;const o={chatroomId:i.value,id:n.value,nick:a.value,content:t,type:e,role:r.value};return o},I=()=>{(0,p.wI)(w("TALK")),v.value=""},S=()=>{(0,p.wI)(w("ENTER"))},E=()=>{m.A.post("/api/chat/isNew",{id:n.value,chatroomId:i.value}).then((e=>{var t=e.data;t&&("USR"==r.value&&_(),S("ENTER"))}))},_=()=>{let e={nick:"TOYCHAT",content:`안녕하세요! 어떻게 도와드릴까요? ${String.fromCodePoint(128522)}`};L.value.push(e)},T=()=>{m.A.post("/api/chat/liveChatList",{chatroomId:i.value}).then((e=>{L.value=e.data}))},R=()=>{var e=window.event.keyCode;C.includes(e)||(13==e?(I(),(0,p.wI)(w("STOP"))):(0,p.wI)(w("TYPING")),clearTimeout(b),b=setTimeout((()=>{(0,p.wI)(w("STOP"))}),3e3))},M=()=>{confirm("종료하시겠습니까?")&&W()},W=()=>{(0,p.wI)(w("END")),i.value="",L.value=[],t("update:modelValue",!1),h.A.emit("reset-chatroom-id")},K=()=>{t("update:modelValue",!1)},O=e=>{c.value=!0,u=e.clientX,g=e.clientY;const t=l.value.getBoundingClientRect();f=t.left,k=t.top},P=()=>{c.value=!1},N=e=>{if(!c.value)return;const t=e.clientX-u,n=e.clientY-g;l.value.style.left=`${f+t}px`,l.value.style.top=`${k+n}px`};return(0,o.wB)((()=>e.modelValue),(e=>{s.value=e,e&&(T(),E())})),(0,o.sV)((()=>{(0,p.SR)(A)})),(0,o.hi)((()=>{(0,p.ST)(A)})),{userId:n,nick:a,role:r,chatroomId:i,visible:s,keyupAction:R,close:M,modalContent:l,startDrag:O,stopDrag:P,drag:N,message:v,messages:L,makeSendBody:w,sendMessage:I,minimize:K,closeProcess:W,typingUsers:y}}},f=n(1241);const k=(0,f.A)(g,[["render",u],["__scopeId","data-v-610531d0"]]);var v=k},9730:function(e,t,n){n.r(t),n.d(t,{default:function(){return l}});var o=n(6768);function a(e,t){return(0,o.uX)(),(0,o.CE)("div")}var r=n(1241);const i={},s=(0,r.A)(i,[["render",a]]);var l=s}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,o,a,r){if(!o){var i=1/0;for(u=0;u<e.length;u++){o=e[u][0],a=e[u][1],r=e[u][2];for(var s=!0,l=0;l<o.length;l++)(!1&r||i>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[l])}))?o.splice(l--,1):(s=!1,r<i&&(i=r));if(s){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[o,a,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,o){return n.f[o](e,t),t}),[]))}}(),function(){n.u=function(e){return"js/"+e+"."+{242:"2e5dd76d",489:"93a95981",573:"e7e87ddd",577:"36fab92b",687:"9b5e9112",913:"af0fc976",940:"4e746a7f",954:"e7e87ddd",961:"15cf65fb"}[e]+".js"}}(),function(){n.miniCssF=function(e){return"css/"+e+"."+{242:"fb549c5f",489:"733c6f10",687:"4e1dbe03",940:"fb549c5f",961:"733c6f10"}[e]+".css"}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="test1:";n.l=function(o,a,r,i){if(e[o])e[o].push(a);else{var s,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==o||d.getAttribute("data-webpack")==t+r){s=d;break}}s||(l=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+r),s.src=o),e[o]=[a];var m=function(t,n){s.onerror=s.onload=null,clearTimeout(h);var a=e[o];if(delete e[o],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach((function(e){return e(n)})),t)return t(n)},h=setTimeout(m.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=m.bind(null,s.onerror),s.onload=m.bind(null,s.onload),l&&document.head.appendChild(s)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,o,a,r){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",n.nc&&(i.nonce=n.nc);var s=function(n){if(i.onerror=i.onload=null,"load"===n.type)a();else{var o=n&&n.type,s=n&&n.target&&n.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+o+": "+s+")");l.name="ChunkLoadError",l.code="CSS_CHUNK_LOAD_FAILED",l.type=o,l.request=s,i.parentNode&&i.parentNode.removeChild(i),r(l)}};return i.onerror=i.onload=s,i.href=t,o?o.parentNode.insertBefore(i,o.nextSibling):document.head.appendChild(i),i},t=function(e,t){for(var n=document.getElementsByTagName("link"),o=0;o<n.length;o++){var a=n[o],r=a.getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(r===e||r===t))return a}var i=document.getElementsByTagName("style");for(o=0;o<i.length;o++){a=i[o],r=a.getAttribute("data-href");if(r===e||r===t)return a}},o=function(o){return new Promise((function(a,r){var i=n.miniCssF(o),s=n.p+i;if(t(i,s))return a();e(o,s,null,a,r)}))},a={524:0};n.f.miniCss=function(e,t){var n={242:1,489:1,687:1,940:1,961:1};a[e]?t.push(a[e]):0!==a[e]&&n[e]&&t.push(a[e]=o(e).then((function(){a[e]=0}),(function(t){throw delete a[e],t})))}}}(),function(){n.b=document.baseURI||self.location.href;var e={524:0};n.f.j=function(t,o){var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)o.push(a[2]);else{var r=new Promise((function(n,o){a=e[t]=[n,o]}));o.push(a[2]=r);var i=n.p+n.u(t),s=new Error,l=function(o){if(n.o(e,t)&&(a=e[t],0!==a&&(e[t]=void 0),a)){var r=o&&("load"===o.type?"missing":o.type),i=o&&o.target&&o.target.src;s.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",s.name="ChunkLoadError",s.type=r,s.request=i,a[1](s)}};n.l(i,l,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,r,i=o[0],s=o[1],l=o[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(l)var u=l(n)}for(t&&t(o);c<i.length;c++)r=i[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(u)},o=self["webpackChunktest1"]=self["webpackChunktest1"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(9997)}));o=n.O(o)})();
//# sourceMappingURL=app.97685fa4.js.map