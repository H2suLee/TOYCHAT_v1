"use strict";(self["webpackChunktest1"]=self["webpackChunktest1"]||[]).push([[459],{5459:function(a,e,t){t.r(e),t.d(e,{default:function(){return L}});var o=t(6768),l=t(4232),n=t(5130);const s={class:"contentW"},r={class:"tbl"},c=["onClick"],u={class:"wd10"},d={class:"wd10"},i=["onClick"];function m(a,e,t,m,g,v){const h=(0,o.g2)("Pagination"),C=(0,o.g2)("ChatHistoryModal"),p=(0,o.g2)("ChatManageModal");return(0,o.uX)(),(0,o.CE)("div",s,[e[5]||(e[5]=(0,o.Lk)("ul",null,[(0,o.Lk)("li",{class:"tit"},"채팅 관리"),(0,o.Lk)("li",{class:"navi"},[(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,"홈"),(0,o.Lk)("li",null,"채팅 관리")])])],-1)),(0,o.Lk)("div",null,[e[4]||(e[4]=(0,o.Lk)("h1",{class:"dpn"},"채팅 관리",-1)),(0,o.Lk)("table",r,[e[3]||(e[3]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("td",{class:"wd6"},"rId"),(0,o.Lk)("td",{class:"wd12"},"생성일"),(0,o.Lk)("td",{class:"wd10"},"답변자"),(0,o.Lk)("td",{class:"wd10"},"문의자"),(0,o.Lk)("td",{class:"wd12"},"마지막 채팅일"),(0,o.Lk)("td",{class:"wd12"},"카테고리"),(0,o.Lk)("td",{class:"wd6"},"관리")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(m.chatrooms?.slice(m.pageStartIdx,m.pageStartIdx+m.ITEM_PER_PAGE),(a=>((0,o.uX)(),(0,o.CE)("tr",{key:a.chatroomId,onClick:e=>m.openChatHistoryModal(a.chatroomId)},[(0,o.Lk)("td",null,(0,l.v_)(a.chatroomId),1),(0,o.Lk)("td",null,(0,l.v_)(a.credt),1),(0,o.Lk)("td",u,(0,l.v_)(Array.isArray(a.adm)?a.adm.map((a=>a.nick)).join(", "):""),1),(0,o.Lk)("td",d,(0,l.v_)(a.usr?.nick||""),1),(0,o.Lk)("td",null,(0,l.v_)(a.lastCredt),1),e[2]||(e[2]=(0,o.Lk)("td",null,"카테고리",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("button",{onClick:(0,n.D$)((e=>m.openChatManageModal(a.chatroomId)),["stop"])}," 관리 ",8,i)])],8,c)))),128))])]),m.chatrooms.length>0?((0,o.uX)(),(0,o.Wv)(h,(0,o.v6)({key:0,list:m.chatrooms},{ITEM_PER_PAGE:m.ITEM_PER_PAGE,PAGE_PER_SECTION:m.PAGE_PER_SECTION},{onChangePage:m.onChangePage}),null,16,["list","onChangePage"])):(0,o.Q3)("",!0)]),(0,o.bF)(C,{modalValue:m.isChatHistoryModalVisible,"onUpdate:modalValue":e[0]||(e[0]=a=>m.isChatHistoryModalVisible=a),chatroomId:m.chatroomId,onResetChatroomId:m.resetChatroomId},null,8,["modalValue","chatroomId","onResetChatroomId"]),(0,o.bF)(p,{modelValue:m.isChatManageModalVisible,"onUpdate:modelValue":e[1]||(e[1]=a=>m.isChatManageModalVisible=a),chatroomId:m.chatroomId,onResetChatroomId:m.resetChatroomId},null,8,["modelValue","chatroomId","onResetChatroomId"])])}var g=t(144),v=t(3173),h=t(9990);const C={key:0,class:"error-message"};function p(a,e,t,s,r,c){return s.visible?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"modal-overlay",onClick:e[7]||(e[7]=(0,n.D$)(((...a)=>s.close&&s.close(...a)),["self"]))},[(0,o.Lk)("div",{class:"modal-content",ref:"modalContent",onMousedown:e[4]||(e[4]=(...a)=>s.startDrag&&s.startDrag(...a)),onMouseup:e[5]||(e[5]=(...a)=>s.stopDrag&&s.stopDrag(...a)),onMousemove:e[6]||(e[6]=(...a)=>s.drag&&s.drag(...a))},[(0,o.Lk)("button",{class:"modal-close",onClick:e[0]||(e[0]=(...a)=>s.close&&s.close(...a))},"×"),e[9]||(e[9]=(0,o.eW)(" 카테고리 : ")),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>s.category=a)},e[8]||(e[8]=[(0,o.Lk)("option",{value:"cate1"},"category1",-1),(0,o.Lk)("option",{value:"cate2"},"category2",-1),(0,o.Lk)("option",{value:"cate3"},"category3",-1)]),512),[[n.u1,s.category]]),e[10]||(e[10]=(0,o.eW)(" 메모 : ")),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":e[2]||(e[2]=a=>s.memo=a),rows:"4",cols:"50"},null,512),[[n.Jo,s.memo]]),s.errorMessage?((0,o.uX)(),(0,o.CE)("p",C,(0,l.v_)(s.errorMessage),1)):(0,o.Q3)("",!0),(0,o.Lk)("button",{onClick:e[3]||(e[3]=(...a)=>s.save&&s.save(...a))},"저장")],544)])):(0,o.Q3)("",!0)}var k={props:{modelValue:{type:Boolean,default:!1},chatroomId:{type:String,default:""}},emits:["update:modelValue","reset-chatroom-id"],setup(a,{emit:e}){const t=(0,g.KR)(""),l=(0,g.KR)(""),n=(0,g.KR)(""),s=(0,o.EW)((()=>a.chatroomId)),r=(0,g.KR)(a.modelValue),c=(0,g.KR)(null);let u=(0,g.KR)(!1),d=0,i=0,m=0,h=0;const C=async()=>{try{const a=await v.A.post("/api/admin/chat/chatManageInfo",{chatroomId:s.value});t.value=a.data.category,l.value=a.data.memo}catch(a){console.error("Error fetching chat list:",a)}},p=()=>{if(k()&&confirm("저장하시겠습니까?")){v.A.post("api/admin/chat/saveChatManageInfo",{chatroomId:s.value,category:t.value,memo:l.value})}},k=()=>t.value?l.value&&l.value.trim()?(n.value="",!0):(n.value="메모를 입력해주세요.",!1):(n.value="카테고리를 선택해주세요.",!1),E=()=>{s.value="",t.value="",l.value="",e("update:modelValue",!1),e("reset-chatroom-id")},I=a=>{u.value=!0,d=a.clientX,i=a.clientY;const e=c.value.getBoundingClientRect();m=e.left,h=e.top},P=()=>{u.value=!1},y=a=>{if(!u.value)return;const e=a.clientX-d,t=a.clientY-i;c.value.style.left=`${m+e}px`,c.value.style.top=`${h+t}px`};return(0,o.wB)((()=>a.modelValue),(a=>{r.value=a})),(0,o.wB)((()=>s.value),(a=>{a&&C()})),{category:t,memo:l,errorMessage:n,chatroomId:s,visible:r,close:E,modalContent:c,startDrag:I,stopDrag:P,drag:y,save:p}}},E=t(1241);const I=(0,E.A)(k,[["render",p],["__scopeId","data-v-c0463d04"]]);var P=I,y=t(9383),_=t(1102),R={components:{ChatHistoryModal:h.A,ChatManageModal:P,Pagination:y.A},setup(){const a=(0,g.KR)(localStorage.getItem("adminId")),e=(0,g.KR)(localStorage.getItem("adminNick")),t=(0,g.KR)([]),l=(0,g.KR)(""),n=(0,g.KR)(!1),s=(0,g.KR)(!1),r=(0,g.KR)(_.y_.ITEM_PER_PAGE),c=(0,g.KR)(_.y_.PAGE_PER_SECTION);let u=(0,g.KR)(1);const d=(0,o.EW)((()=>(u.value-1)*r.value)),i=a=>{u.value=a},m=async()=>{try{const e=await v.A.post("/api/admin/chat/mnglist",{id:a.value});t.value=e.data}catch(e){console.error("Error fetching mnglist:",e)}},h=a=>{console.log("id: ",a),l.value=a,n.value=!0},C=a=>{l.value=a,s.value=!0},p=()=>{l.value=""};return(0,o.sV)((()=>{m()})),{userId:a,nick:e,chatrooms:t,chatroomId:l,isChatHistoryModalVisible:n,isChatManageModalVisible:s,openChatHistoryModal:h,openChatManageModal:C,resetChatroomId:p,ITEM_PER_PAGE:r,PAGE_PER_SECTION:c,pageStartIdx:d,onChangePage:i}}};const f=(0,E.A)(R,[["render",m]]);var L=f},9383:function(a,e,t){t.d(e,{A:function(){return h}});var o=t(6768),l=t(4232);const n={style:{display:"flex","align-items":"center"}},s={key:0},r=["onClick"],c={key:1};function u(a,e,t,u,d,i){return(0,o.uX)(),(0,o.CE)("div",n,[a.leftmostPage>t.PAGE_PER_SECTION?((0,o.uX)(),(0,o.CE)("span",s,[(0,o.Lk)("a",{onClick:e[0]||(e[0]=()=>{a.leftmostPage-=t.PAGE_PER_SECTION,a.onChangeCurPage(a.leftmostPage)})},"<")])):(0,o.Q3)("",!0),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.getPaginationArray(a.leftmostPage),(e=>((0,o.uX)(),(0,o.CE)("span",{class:"page",key:e},[(0,o.Lk)("a",{class:(0,l.C4)({on:e===a.curPage}),onClick:()=>{a.onChangeCurPage(e)}},(0,l.v_)(e),11,r)])))),128)),a.leftmostPage+t.PAGE_PER_SECTION<=a.totalPage?((0,o.uX)(),(0,o.CE)("span",c,[(0,o.Lk)("a",{onClick:e[1]||(e[1]=()=>{a.leftmostPage+=t.PAGE_PER_SECTION,a.onChangeCurPage(a.leftmostPage)})},">")])):(0,o.Q3)("",!0)])}t(4114);var d=t(144),i={props:{list:Array,ITEM_PER_PAGE:Number,PAGE_PER_SECTION:Number},emits:["change-page"],setup(a,{emit:e}){return{...m(a,e)}}};const m=(a,e)=>{const t=(0,d.KR)(1),o=(0,d.KR)(1),l=Math.ceil(a.list.length/(a.ITEM_PER_PAGE||1)),n=e=>{const t=[];for(let o=e;o<Math.min(l+1,e+a.PAGE_PER_SECTION);o++)t.push(o);return t},s=a=>{t.value=a,e("change-page",a)};return{leftmostPage:o,curPage:t,totalPage:l,getPaginationArray:n,onChangeCurPage:s}};var g=t(1241);const v=(0,g.A)(i,[["render",u]]);var h=v},9990:function(a,e,t){t.d(e,{A:function(){return m}});var o=t(6768),l=t(5130),n=t(4232);function s(a,e,t,s,r,c){return s.visible?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"modal-overlay",onClick:e[4]||(e[4]=(0,l.D$)(((...a)=>s.close&&s.close(...a)),["self"]))},[(0,o.Lk)("div",{class:"modal-content",ref:"modalContent",onMousedown:e[1]||(e[1]=(...a)=>s.startDrag&&s.startDrag(...a)),onMouseup:e[2]||(e[2]=(...a)=>s.stopDrag&&s.stopDrag(...a)),onMousemove:e[3]||(e[3]=(...a)=>s.drag&&s.drag(...a))},[(0,o.Lk)("button",{class:"modal-close",onClick:e[0]||(e[0]=(...a)=>s.close&&s.close(...a))},"×"),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.messages,((a,e)=>((0,o.uX)(),(0,o.CE)("div",{key:e},[(0,o.Lk)("p",null,(0,n.v_)(a.nick)+" : "+(0,n.v_)(a.content),1)])))),128))],544)])):(0,o.Q3)("",!0)}var r=t(144),c=t(3173),u={props:{modalValue:{type:Boolean,default:!1},chatroomId:{type:String,default:""}},emits:["update:modalValue","reset-chatroom-id"],setup(a,{emit:e}){const t=(0,o.EW)((()=>a.chatroomId)),l=(0,r.KR)(a.modalValue),n=(0,r.KR)(null);let s=(0,r.KR)(!1),u=0,d=0,i=0,m=0;const g=(0,r.KR)("");let v=(0,r.KR)([]);const h=async()=>{try{const a=await c.A.post("/api/chat/chatList",{chatroomId:t.value});v.value=a.data}catch(a){console.error("Error fetching modal history list:",a)}},C=()=>{t.value="",v.value=[],e("update:modalValue",!1),e("reset-chatroom-id")},p=a=>{s.value=!0,u=a.clientX,d=a.clientY;const e=n.value.getBoundingClientRect();i=e.left,m=e.top},k=()=>{s.value=!1},E=a=>{if(!s.value)return;const e=a.clientX-u,t=a.clientY-d;n.value.style.left=`${i+e}px`,n.value.style.top=`${m+t}px`};return(0,o.wB)((()=>a.modalValue),(a=>{l.value=a})),(0,o.wB)((()=>t.value),(a=>{a&&h()})),{chatroomId:t,visible:l,close:C,modalContent:n,startDrag:p,stopDrag:k,drag:E,message:g,messages:v}}},d=t(1241);const i=(0,d.A)(u,[["render",s]]);var m=i}}]);
//# sourceMappingURL=459.599190b6.js.map