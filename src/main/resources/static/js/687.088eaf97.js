"use strict";(self["webpackChunktest1"]=self["webpackChunktest1"]||[]).push([[687],{4687:function(a,e,t){t.r(e),t.d(e,{default:function(){return P}});var o=t(6768),l=t(4232),s=t(5130);const n={class:"contentW"},r={class:"tbl"},d=["onClick"],c={class:"wd10"},u={class:"wd10"},i=["onClick"];function m(a,e,t,m,h,v){const g=(0,o.g2)("Pagination"),k=(0,o.g2)("ChatHistoryModal"),C=(0,o.g2)("ChatManageModal");return(0,o.uX)(),(0,o.CE)("div",n,[e[5]||(e[5]=(0,o.Lk)("ul",null,[(0,o.Lk)("li",{class:"tit"},"채팅 관리"),(0,o.Lk)("li",{class:"navi"},[(0,o.Lk)("ul",null,[(0,o.Lk)("li",null,"홈"),(0,o.Lk)("li",null,"채팅 관리")])])],-1)),(0,o.Lk)("div",null,[e[4]||(e[4]=(0,o.Lk)("h1",{class:"dpn"},"채팅 관리",-1)),(0,o.Lk)("table",r,[e[3]||(e[3]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("td",{class:"wd6"},"rId"),(0,o.Lk)("td",{class:"wd12"},"생성일"),(0,o.Lk)("td",{class:"wd10"},"답변자"),(0,o.Lk)("td",{class:"wd10"},"문의자"),(0,o.Lk)("td",{class:"wd12"},"마지막 채팅일"),(0,o.Lk)("td",{class:"wd12"},"카테고리"),(0,o.Lk)("td",{class:"wd6"},"관리")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(m.chatrooms?.slice(m.pageStartIdx,m.pageStartIdx+m.ITEM_PER_PAGE),(a=>((0,o.uX)(),(0,o.CE)("tr",{key:a.chatroomId,onClick:e=>m.openChatHistoryModal(a.chatroomId)},[(0,o.Lk)("td",null,(0,l.v_)(a.chatroomId),1),(0,o.Lk)("td",null,(0,l.v_)(a.credt),1),(0,o.Lk)("td",c,(0,l.v_)(Array.isArray(a.adm)?a.adm.map((a=>a.nick)).join(", "):""),1),(0,o.Lk)("td",u,(0,l.v_)(a.usr?.nick||""),1),(0,o.Lk)("td",null,(0,l.v_)(a.lastCredt),1),e[2]||(e[2]=(0,o.Lk)("td",null,"카테고리",-1)),(0,o.Lk)("td",null,[(0,o.Lk)("button",{onClick:(0,s.D$)((e=>m.openChatManageModal(a.chatroomId)),["stop"])}," 관리 ",8,i)])],8,d)))),128))])]),m.chatrooms.length>0?((0,o.uX)(),(0,o.Wv)(g,(0,o.v6)({key:0,list:m.chatrooms},{ITEM_PER_PAGE:m.ITEM_PER_PAGE,PAGE_PER_SECTION:m.PAGE_PER_SECTION},{onChangePage:m.onChangePage}),null,16,["list","onChangePage"])):(0,o.Q3)("",!0)]),(0,o.bF)(k,{modalValue:m.isChatHistoryModalVisible,"onUpdate:modalValue":e[0]||(e[0]=a=>m.isChatHistoryModalVisible=a),chatroomId:m.chatroomId,onResetChatroomId:m.resetChatroomId},null,8,["modalValue","chatroomId","onResetChatroomId"]),(0,o.bF)(C,{modalValue:m.isChatManageModalVisible,"onUpdate:modalValue":e[1]||(e[1]=a=>m.isChatManageModalVisible=a),chatroomId:m.chatroomId,onResetChatroomId:m.resetChatroomId},null,8,["modalValue","chatroomId","onResetChatroomId"])])}var h=t(144),v=t(3173),g=t(3476);const k={key:0,class:"error-message"};function C(a,e,t,n,r,d){return n.visible?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"modal-overlay",onClick:e[7]||(e[7]=(0,s.D$)(((...a)=>n.close&&n.close(...a)),["self"]))},[(0,o.Lk)("div",{class:"modal-content",ref:"modalContent",onMousedown:e[4]||(e[4]=(...a)=>n.startDrag&&n.startDrag(...a)),onMouseup:e[5]||(e[5]=(...a)=>n.stopDrag&&n.stopDrag(...a)),onMousemove:e[6]||(e[6]=(...a)=>n.drag&&n.drag(...a))},[(0,o.Lk)("button",{class:"modal-close",onClick:e[0]||(e[0]=(...a)=>n.close&&n.close(...a))},"×"),e[9]||(e[9]=(0,o.eW)(" 카테고리 : ")),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":e[1]||(e[1]=a=>n.category=a)},e[8]||(e[8]=[(0,o.Lk)("option",{value:"cate1"},"category1",-1),(0,o.Lk)("option",{value:"cate2"},"category2",-1),(0,o.Lk)("option",{value:"cate3"},"category3",-1)]),512),[[s.u1,n.category]]),e[10]||(e[10]=(0,o.eW)(" 메모 : ")),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":e[2]||(e[2]=a=>n.memo=a),rows:"4",cols:"50"},null,512),[[s.Jo,n.memo]]),n.errorMessage?((0,o.uX)(),(0,o.CE)("p",k,(0,l.v_)(n.errorMessage),1)):(0,o.Q3)("",!0),(0,o.Lk)("button",{onClick:e[3]||(e[3]=(...a)=>n.save&&n.save(...a))},"저장")],544)])):(0,o.Q3)("",!0)}var p={props:{modalValue:{type:Boolean,default:!1},chatroomId:{type:String,default:""}},emits:["update:modalValue","reset-chatroom-id"],setup(a,{emit:e}){const t=(0,h.KR)(""),l=(0,h.KR)(""),s=(0,h.KR)(""),n=(0,o.EW)((()=>a.chatroomId)),r=(0,h.KR)(a.modalValue),d=(0,h.KR)(null);let c=(0,h.KR)(!1),u=0,i=0,m=0,g=0;const k=async()=>{try{const a=await v.A.post("/api/admin/chat/chatManageInfo",{chatroomId:n.value});t.value=a.data.category,l.value=a.data.memo}catch(a){console.error("Error fetching chat list:",a)}},C=()=>{if(p()&&confirm("저장하시겠습니까?")){v.A.post("api/admin/chat/saveChatManageInfo",{chatroomId:n.value,category:t.value,memo:l.value})}},p=()=>t.value?l.value&&l.value.trim()?(s.value="",!0):(s.value="메모를 입력해주세요.",!1):(s.value="카테고리를 선택해주세요.",!1),I=()=>{n.value="",t.value="",l.value="",e("update:modalValue",!1),e("reset-chatroom-id")},E=a=>{c.value=!0,u=a.clientX,i=a.clientY;const e=d.value.getBoundingClientRect();m=e.left,g=e.top},L=()=>{c.value=!1},M=a=>{if(!c.value)return;const e=a.clientX-u,t=a.clientY-i;d.value.style.left=`${m+e}px`,d.value.style.top=`${g+t}px`};return(0,o.wB)((()=>a.modalValue),(a=>{r.value=a})),(0,o.wB)((()=>n.value),(a=>{a&&k()})),{category:t,memo:l,errorMessage:s,chatroomId:n,visible:r,close:I,modalContent:d,startDrag:E,stopDrag:L,drag:M,save:C}}},I=t(1241);const E=(0,I.A)(p,[["render",C],["__scopeId","data-v-0df8c3fc"]]);var L=E,M=t(9383),y=t(1102),R={components:{ChatHistoryModal:g.A,ChatManageModal:L,Pagination:M.A},setup(){const a=(0,h.KR)(localStorage.getItem("adminId")),e=(0,h.KR)(localStorage.getItem("adminNick")),t=(0,h.KR)([]),l=(0,h.KR)(""),s=(0,h.KR)(!1),n=(0,h.KR)(!1),r=(0,h.KR)(y.y.ITEM_PER_PAGE),d=(0,h.KR)(y.y.PAGE_PER_SECTION);let c=(0,h.KR)(1);const u=(0,o.EW)((()=>(c.value-1)*r.value)),i=a=>{c.value=a},m=async()=>{try{const e=await v.A.post("/api/admin/chat/mnglist",{id:a.value});t.value=e.data}catch(e){console.error("Error fetching mnglist:",e)}},g=a=>{console.log("id: ",a),l.value=a,s.value=!0},k=a=>{l.value=a,n.value=!0},C=()=>{l.value=""};return(0,o.sV)((()=>{m()})),{userId:a,nick:e,chatrooms:t,chatroomId:l,isChatHistoryModalVisible:s,isChatManageModalVisible:n,openChatHistoryModal:g,openChatManageModal:k,resetChatroomId:C,ITEM_PER_PAGE:r,PAGE_PER_SECTION:d,pageStartIdx:u,onChangePage:i}}};const _=(0,I.A)(R,[["render",m]]);var P=_}}]);
//# sourceMappingURL=687.088eaf97.js.map